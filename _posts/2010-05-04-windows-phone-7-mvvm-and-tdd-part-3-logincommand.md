---
layout: post
title: Windows Phone 7, MVVM and TDD (Part 3 – LoginCommand)
date: 2010-05-04 23:54
author: peted70
comments: true
categories: [MVVM, TDD, Windows Phone 7]
---
<div id="msgcns!4F1B7368284539E5!241" class="bvMsg"><p>by Peter Daukintis</p> <p>Now, to support the login functionality I will add a password property in exactly the same way (test first) as the username text property from part 2 (<a href="http://babaandthepigman.spaces.live.com/blog/cns!4F1B7368284539E5!237.entry">http://babaandthepigman.spaces.live.com/blog/cns!4F1B7368284539E5!237.entry</a>). Also I will supplement the tests with tests to check the values are set, similar to the following:</p><pre>        <span style="color:#d2d200;">[</span><span style="color:#f0dfaf;">TestMethod</span><span style="color:#d2d200;">]
        </span><span style="color:#eaeaac;">public void </span><span style="color:#f8ffc6;">UsernameText_SetValue_ResultsInNewValue</span><span style="color:#d2d200;">()
        &#123;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">mainViewModel </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">MainViewModel</span><span style="color:#d2d200;">();

            </span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">UsernameText </span><span style="color:#d2d200;">= </span><span style="color:#c89191;">&quot;fred&quot;</span><span style="color:#d2d200;">;
            </span><span style="color:#f0dfaf;">Assert</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">AreEqual</span><span style="color:#d2d200;">(</span><span style="color:#c89191;">&quot;fred&quot;</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">UsernameText</span><span style="color:#d2d200;">);
        &#125;</span></pre>
<p>Now I have all the required user input properties, I will turn my attention towards how the login command will get invoked. Following the MVVM style we would like to expose some implementation code to be available to be data-bound to the user interface. Now in WPF, this can be achieved via the ICommand interface which can be bound to the ui. However, Windows Phone is based upon Silverlight 3 which has no support for the ICommand interface. There are a number of ways to hook this functionality in yourself but I will use one way provided for me by the MVVM Light framework. First I will implement the ICommand supporting code then we will see how to wire it all up. </p>
<p>So, first create a new ICommand property for the login command:</p><pre>        <span style="color:#eaeaac;">public </span><span style="color:#2b91af;">ICommand </span><span style="color:#f8ffc6;">LoginCommand </span><span style="color:#d2d200;">&#123; </span><span style="color:#eaeaac;">get</span><span style="color:#d2d200;">; </span><span style="color:#eaeaac;">set</span><span style="color:#d2d200;">; &#125;
</span></pre>
<p>And, in the MainViewModel constructor instantiate it with a RelayCommand:</p><pre>            <span style="color:#f8ffc6;">LoginCommand </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">RelayCommand</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">ExecuteLogin</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">CanExecuteLogin</span><span style="color:#d2d200;">);

</span></pre>
<p><a href="http://11011.net/software/vspaste"></a>supplied by the MVVM Light framework. (For further information on the RelayCommand see <a href="http://babaandthepigman.spaces.live.com/blog/cns!4F1B7368284539E5!167.entry">http://babaandthepigman.spaces.live.com/blog/cns!4F1B7368284539E5!167.entry</a> and <a href="http://msdn.microsoft.com/en-us/magazine/dd419663.aspx">http://msdn.microsoft.com/en-us/magazine/dd419663.aspx</a>).</p>
<p>Basically the ExecuteLogin and CanExecuteLogin are delegates which clients can supply to be called when the ICommand interface is called (ICommand has two methods CanExecute and Execute).</p>
<p>These two methods declared in the MainViewModel keep everything compiling:</p><pre>        <span style="color:#eaeaac;">private bool </span><span style="color:#f8ffc6;">CanExecuteLogin</span><span style="color:#d2d200;">() &#123; </span><span style="color:#eaeaac;">return true</span><span style="color:#d2d200;">; &#125;
        </span><span style="color:#eaeaac;">private void </span><span style="color:#f8ffc6;">ExecuteLogin</span><span style="color:#d2d200;">() &#123;  &#125;

</span></pre>
<p>Now, I have enough to begin writing tests for the login command.</p>
<p>I can start my first test off with something like this:</p><pre>        <span style="color:#d2d200;">[</span><span style="color:#f0dfaf;">TestMethod</span><span style="color:#d2d200;">]
        </span><span style="color:#eaeaac;">public void </span><span style="color:#f8ffc6;">LoginCommand_ExecutedWithValidLogin_ResultsInSuccessfulLogin</span><span style="color:#d2d200;">()
        &#123;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">mainViewModel </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">MainViewModel</span><span style="color:#d2d200;">();
            </span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">LoginCommand</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Execute</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">null</span><span style="color:#d2d200;">);
        &#125;

</span></pre>
<p><a href="http://11011.net/software/vspaste"></a>But, I am now forced to think about how my login will be provided and also what state it will act upon, since currently I have no state or behaviour to assert on in my tests. Ultimately, the login functionality will be provided by my model layer so to enable a clear separation of concerns I will use an IUserRepository interface to provide the functionality (see <a href="http://babaandthepigman.spaces.live.com/blog/cns!4F1B7368284539E5!202.entry">http://babaandthepigman.spaces.live.com/blog/cns!4F1B7368284539E5!202.entry</a> for a discussion on why this would be a good idea). The IUserRepository is defined as follows:</p><pre>    <span style="color:#eaeaac;">public interface </span><span style="color:#2b91af;">IUserRepository
    </span><span style="color:#d2d200;">&#123;
        </span><span style="color:#eaeaac;">bool </span><span style="color:#f8ffc6;">Login</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">string </span><span style="color:#f8ffc6;">username</span><span style="color:#d2d200;">, </span><span style="color:#eaeaac;">string </span><span style="color:#f8ffc6;">password</span><span style="color:#d2d200;">);
    &#125;

</span></pre>
<p>and our login function in our view model can call it and not really worry about how or where it is implemented.</p>
<p>So, our first naive implementation of the ExecuteLogin call will just call IUserRepository::Login. But first it needs a reference to one and to keep everything nice and flexible we will allow one to be passed in to the constructor of the view model.</p>
<p>So, pass it in and initialise a private field.</p><pre>       <span style="color:#eaeaac;">public </span><span style="color:#f8ffc6;">MainViewModel</span><span style="color:#d2d200;">(</span><span style="color:#2b91af;">IUserRepository </span><span style="color:#f8ffc6;">repository</span><span style="color:#d2d200;">)
        &#123;
            </span><span style="color:#f8ffc6;">Repository </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">repository</span><span style="color:#d2d200;">;
</span></pre>
<p><span style="color:#d2d200;"><font color="#ffffff">Then, our ExecuteLogin call can become:</font></span></p><pre>        <span style="color:#eaeaac;">private void </span><span style="color:#f8ffc6;">ExecuteLogin</span><span style="color:#d2d200;">()
        &#123;
            </span><span style="color:#f8ffc6;">IsLoggedIn </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">Repository</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Login</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">UsernameText</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">PasswordText</span><span style="color:#d2d200;">);
        &#125;
</span></pre>
<p>Where IsLoggedIn is a boolean property. Back to our unit tests which will need refactoring since they will no longer compile. In order to get them compiling we need to supply a reference to an IUserRepository when we construct the view model. So we will create a Fake user repository like this:</p><pre>    <span style="color:#eaeaac;">public class </span><span style="color:#f0dfaf;">FakeUserRepository </span><span style="color:#d2d200;">: </span><span style="color:#2b91af;">IUserRepository
    </span><span style="color:#d2d200;">&#123;
        </span><span style="color:#eaeaac;">public </span><span style="color:#2b91af;">Func</span><span style="color:#d2d200;">&lt;</span><span style="color:#eaeaac;">string</span><span style="color:#d2d200;">, </span><span style="color:#eaeaac;">string</span><span style="color:#d2d200;">, </span><span style="color:#eaeaac;">bool</span><span style="color:#d2d200;">&gt; </span><span style="color:#f8ffc6;">LoginAction </span><span style="color:#d2d200;">&#123; </span><span style="color:#eaeaac;">get</span><span style="color:#d2d200;">; </span><span style="color:#eaeaac;">set</span><span style="color:#d2d200;">; &#125;

        </span><span style="color:#dfaf8f;">#region </span><span style="color:#d2d200;">Implementation of IUserRepository

        </span><span style="color:#eaeaac;">public bool </span><span style="color:#f8ffc6;">Login</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">string </span><span style="color:#f8ffc6;">username</span><span style="color:#d2d200;">, </span><span style="color:#eaeaac;">string </span><span style="color:#f8ffc6;">password</span><span style="color:#d2d200;">)
        &#123;
            </span><span style="color:#eaeaac;">if </span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">LoginAction </span><span style="color:#d2d200;">!= </span><span style="color:#eaeaac;">null</span><span style="color:#d2d200;">)
                </span><span style="color:#eaeaac;">return </span><span style="color:#f8ffc6;">LoginAction</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">username</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">password</span><span style="color:#d2d200;">);
            </span><span style="color:#eaeaac;">return true</span><span style="color:#d2d200;">;
        &#125;

        </span><span style="color:#dfaf8f;">#endregion
    </span><span style="color:#d2d200;">&#125;

</span></pre>
<p>This allows our test to modify the logic inside the Login call by providing a delegate which may be useful moving forwards. So, now in our tests each call to construct the view model can be replaced by:</p><pre>            <span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">fakeUserRepository </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">FakeUserRepository</span><span style="color:#d2d200;">();
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">mainViewModel </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">MainViewModel</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">fakeUserRepository</span><span style="color:#d2d200;">);

</span></pre><a href="http://11011.net/software/vspaste"></a>
<p>and the test method we were working on can become this:</p><pre>        <span style="color:#d2d200;">[</span><span style="color:#f0dfaf;">TestMethod</span><span style="color:#d2d200;">]
        </span><span style="color:#eaeaac;">public void </span><span style="color:#f8ffc6;">LoginCommand_ExecutedWithValidLogin_ResultsInSuccessfulLogin</span><span style="color:#d2d200;">()
        &#123;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">fakeUserRepository </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">FakeUserRepository</span><span style="color:#d2d200;">();
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">mainViewModel </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">MainViewModel</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">fakeUserRepository</span><span style="color:#d2d200;">);

            </span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">UsernameText </span><span style="color:#d2d200;">= </span><span style="color:#c89191;">&quot;fred&quot;</span><span style="color:#d2d200;">;
            </span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">PasswordText </span><span style="color:#d2d200;">= </span><span style="color:#c89191;">&quot;fred&quot;</span><span style="color:#d2d200;">;

            </span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">LoginCommand</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Execute</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">null</span><span style="color:#d2d200;">);

            </span><span style="color:#f0dfaf;">Assert</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">IsTrue</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">IsLoggedIn</span><span style="color:#d2d200;">);
        &#125;

</span></pre>
<p>Now, we need to think a bit as the ExecuteLogin call is going to block the UI thread whilst it executes which is clearly no good in our Silverlight environment. So, if we make the login call asynchronous how will we be able to unit test it? Well, the Silverlight Unit Test framework supports this and this is how it’s done:</p>
<p>Firstly, my ExecuteLogin method becomes:</p><pre>        <span style="color:#eaeaac;">private void </span><span style="color:#f8ffc6;">ExecuteLogin</span><span style="color:#d2d200;">()
        &#123;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">backgroundWorker </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">BackgroundWorker</span><span style="color:#d2d200;">();
            </span><span style="color:#f8ffc6;">backgroundWorker</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">DoWork </span><span style="color:#d2d200;">+= </span><span style="color:#f8ffc6;">BackgroundWorkerDoWork</span><span style="color:#d2d200;">;
            </span><span style="color:#f8ffc6;">backgroundWorker</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">RunWorkerCompleted </span><span style="color:#d2d200;">+= </span><span style="color:#f8ffc6;">BackgroundWorkerRunWorkerCompleted</span><span style="color:#d2d200;">;
            </span><span style="color:#f8ffc6;">backgroundWorker</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">RunWorkerAsync</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">Userdata </span><span style="color:#d2d200;">&#123; </span><span style="color:#f8ffc6;">Username </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">UsernameText</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">Password </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">PasswordText </span><span style="color:#d2d200;">&#125;);
        &#125;

        </span><span style="color:#eaeaac;">void </span><span style="color:#f8ffc6;">BackgroundWorkerDoWork</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">object </span><span style="color:#f8ffc6;">sender</span><span style="color:#d2d200;">, </span><span style="color:#f0dfaf;">DoWorkEventArgs </span><span style="color:#f8ffc6;">e</span><span style="color:#d2d200;">)
        &#123;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">argument </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">e</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Argument </span><span style="color:#eaeaac;">as </span><span style="color:#f0dfaf;">Userdata</span><span style="color:#d2d200;">;
            </span><span style="color:#eaeaac;">if </span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">argument </span><span style="color:#d2d200;">== </span><span style="color:#eaeaac;">null</span><span style="color:#d2d200;">)
            &#123;
                </span><span style="color:#f8ffc6;">e</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Result </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">false</span><span style="color:#d2d200;">;
                </span><span style="color:#eaeaac;">return</span><span style="color:#d2d200;">;
            &#125;

            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">password </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">argument</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Password</span><span style="color:#d2d200;">;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">username </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">argument</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Username</span><span style="color:#d2d200;">;

            </span><span style="color:#f8ffc6;">e</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Result </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">Repository</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Login</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">username</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">password</span><span style="color:#d2d200;">);
        &#125;

        </span><span style="color:#eaeaac;">private void </span><span style="color:#f8ffc6;">BackgroundWorkerRunWorkerCompleted</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">object </span><span style="color:#f8ffc6;">sender</span><span style="color:#d2d200;">, </span><span style="color:#f0dfaf;">RunWorkerCompletedEventArgs </span><span style="color:#f8ffc6;">e</span><span style="color:#d2d200;">)
        &#123;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">result </span><span style="color:#d2d200;">= (</span><span style="color:#eaeaac;">bool</span><span style="color:#d2d200;">)</span><span style="color:#f8ffc6;">e</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Result</span><span style="color:#d2d200;">;
            </span><span style="color:#f8ffc6;">IsLoggedIn </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">result</span><span style="color:#d2d200;">;

            </span><span style="color:#eaeaac;">if </span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">IsLoggedIn </span><span style="color:#d2d200;">== </span><span style="color:#eaeaac;">false</span><span style="color:#d2d200;">)
            &#123;
                </span><span style="color:#f8ffc6;">UsernameText </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">string</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Empty</span><span style="color:#d2d200;">;
                </span><span style="color:#f8ffc6;">PasswordText </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">string</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Empty</span><span style="color:#d2d200;">;
            &#125;
            </span><span style="color:#eaeaac;">else
            </span><span style="color:#d2d200;">&#123;
                </span><span style="color:lime;">// navigate to another page...
                //VisualStateManager.GoToState()
            </span><span style="color:#d2d200;">&#125;
        &#125;

</span></pre>
<p>With an additional helper class to pass around the user credentials:</p><pre>    <span style="color:#eaeaac;">public class </span><span style="color:#f0dfaf;">Userdata
    </span><span style="color:#d2d200;">&#123;
        </span><span style="color:#eaeaac;">public string </span><span style="color:#f8ffc6;">Username </span><span style="color:#d2d200;">&#123; </span><span style="color:#eaeaac;">get</span><span style="color:#d2d200;">; </span><span style="color:#eaeaac;">set</span><span style="color:#d2d200;">; &#125;
        </span><span style="color:#eaeaac;">public string </span><span style="color:#f8ffc6;">Password </span><span style="color:#d2d200;">&#123; </span><span style="color:#eaeaac;">get</span><span style="color:#d2d200;">; </span><span style="color:#eaeaac;">set</span><span style="color:#d2d200;">; &#125;
    &#125;

</span></pre>
<p>Now if I run my unit test the Login method will return immediately and the background worker will run on – we need to wait until the background worker finishes before we can assert on IsLoggedIn. The unit test becomes:</p><pre>        <span style="color:#d2d200;">[</span><span style="color:#f0dfaf;">TestMethod</span><span style="color:#d2d200;">]
        [</span><span style="color:#f0dfaf;">Asynchronous</span><span style="color:#d2d200;">]
        </span><span style="color:#eaeaac;">public void </span><span style="color:#f8ffc6;">LoginCommand_ExecutedWithValidLogin_ResultsInSuccessfulLogin</span><span style="color:#d2d200;">()
        &#123;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">fakeUserRepository </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">FakeUserRepository</span><span style="color:#d2d200;">();
            </span><span style="color:#f8ffc6;">fakeUserRepository</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">LoginAction </span><span style="color:#d2d200;">= (</span><span style="color:#f8ffc6;">u</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">p</span><span style="color:#d2d200;">) =&gt; </span><span style="color:#eaeaac;">true</span><span style="color:#d2d200;">;

            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">mainViewModel </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">MainViewModel</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">fakeUserRepository</span><span style="color:#d2d200;">) &#123; </span><span style="color:#f8ffc6;">UsernameText </span><span style="color:#d2d200;">= </span><span style="color:#c89191;">&quot;fred&quot;</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">PasswordText </span><span style="color:#d2d200;">= </span><span style="color:#c89191;">&quot;fred&quot; </span><span style="color:#d2d200;">&#125;;

            </span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">LoginCommand</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Execute</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">null</span><span style="color:#d2d200;">);

            </span><span style="color:#f8ffc6;">EnqueueConditional</span><span style="color:#d2d200;">(() =&gt; </span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">IsLoading </span><span style="color:#d2d200;">== </span><span style="color:#eaeaac;">false</span><span style="color:#d2d200;">);
            </span><span style="color:#f8ffc6;">EnqueueCallback</span><span style="color:#d2d200;">(() =&gt; </span><span style="color:#f0dfaf;">Assert</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">IsTrue</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">IsLoggedIn</span><span style="color:#d2d200;">));
            </span><span style="color:#f8ffc6;">EnqueueTestComplete</span><span style="color:#d2d200;">();
        &#125;

</span></pre>
<p>First note the Asynchronous attribute added to the test method – this denotes that the test will run some async code. Also, notice the Enqueue… methods: The EnqueueConditional call will block until the condition calculates to true, so in our case when IsLoading is false (IsLoading is a boolean property set to true whilst loading is in progress, otherwise false) i.e. the loading is complete. Then we can correctly assert the IsLoggedIn property. For further details of the Enqueue methods see <a href="http://www.jeff.wilcox.name/2009/03/asynchronous-testing/">http://www.jeff.wilcox.name/2009/03/asynchronous-testing/</a>.</p>
<p>Sprinkle on a few more tests (test invalid login and CanExecute);</p><pre>        <span style="color:#d2d200;">[</span><span style="color:#f0dfaf;">TestMethod</span><span style="color:#d2d200;">]
        [</span><span style="color:#f0dfaf;">Asynchronous</span><span style="color:#d2d200;">]
        </span><span style="color:#eaeaac;">public void </span><span style="color:#f8ffc6;">LoginCommand_ExecutedWithInValidLogin_ResultsInFailedLogin</span><span style="color:#d2d200;">()
        &#123;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">fakeUserRepository </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">FakeUserRepository</span><span style="color:#d2d200;">();
            </span><span style="color:#f8ffc6;">fakeUserRepository</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">LoginAction </span><span style="color:#d2d200;">= (</span><span style="color:#f8ffc6;">u</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">p</span><span style="color:#d2d200;">) =&gt; </span><span style="color:#eaeaac;">false</span><span style="color:#d2d200;">;

            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">mainViewModel </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">MainViewModel</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">fakeUserRepository</span><span style="color:#d2d200;">);
            </span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">LoginCommand</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Execute</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">null</span><span style="color:#d2d200;">);
            </span><span style="color:#f8ffc6;">EnqueueConditional</span><span style="color:#d2d200;">(() =&gt; </span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">IsLoading </span><span style="color:#d2d200;">== </span><span style="color:#eaeaac;">false</span><span style="color:#d2d200;">);
            </span><span style="color:#f8ffc6;">EnqueueCallback</span><span style="color:#d2d200;">(() =&gt; </span><span style="color:#f0dfaf;">Assert</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">IsFalse</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">IsLoggedIn</span><span style="color:#d2d200;">));
            </span><span style="color:#f8ffc6;">EnqueueTestComplete</span><span style="color:#d2d200;">();
        &#125;

        [</span><span style="color:#f0dfaf;">TestMethod</span><span style="color:#d2d200;">]
        </span><span style="color:#eaeaac;">public void </span><span style="color:#f8ffc6;">LoginCommand_CanExecuteReturnsTrue_GivenValidUsernameAndPassword</span><span style="color:#d2d200;">()
        &#123;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">fakeUserRepository </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">FakeUserRepository</span><span style="color:#d2d200;">();

            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">mainViewModel </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">MainViewModel</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">fakeUserRepository</span><span style="color:#d2d200;">) &#123; </span><span style="color:#f8ffc6;">UsernameText </span><span style="color:#d2d200;">= </span><span style="color:#c89191;">&quot;user&quot;</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">PasswordText </span><span style="color:#d2d200;">= </span><span style="color:#c89191;">&quot;pwd&quot; </span><span style="color:#d2d200;">&#125;;

            </span><span style="color:#eaeaac;">bool </span><span style="color:#f8ffc6;">canExecute </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">mainViewModel</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">LoginCommand</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">CanExecute</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">null</span><span style="color:#d2d200;">);
            </span><span style="color:#f0dfaf;">Assert</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">IsTrue</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">canExecute</span><span style="color:#d2d200;">);
        &#125;
</span><span style="color:#d2d200;"></span></pre>
<p><span style="color:#d2d200;"><font color="#ffffff">Results in the following ‘green’ tests…hmmm…satisfying….</font> </span></p>
<p> </p>
<p><a href="https://omlweq.bay.livefilestore.com/y1m6YHXD-Qgdmqq6dww4lWrwXr5MOTbV8RbqKpvjNTGXnanUihU-7H_ZR1Fc1iWKqhVEUZnRX9hxXza74_ZZpvikH2AxrNV0ITJup0JZXKroUyCY2pxOYYY0MFx3PSjCoatSheLS-iMYwdUO6gdNiWH9A/WP7LoginGreenTests5.png" rel="WLPP"><img style="display:block;float:none;margin-left:auto;margin-right:auto;border-width:0;" title="WP7LoginGreenTests" border="0" alt="WP7LoginGreenTests" src="http://peted.azurewebsites.net/wp-content/uploads/2010/09/wp7logingreentests_thumb3.png?w=171" width="393" height="689" /></a> </p>
<p></p>Technorati Tags: <a href="http://technorati.com/tags/MVVM" rel="tag">MVVM</a>,<a href="http://technorati.com/tags/Part" rel="tag">Part</a>,<a href="http://technorati.com/tags/LoginCommand" rel="tag">LoginCommand</a>,<a href="http://technorati.com/tags/password" rel="tag">password</a>,<a href="http://technorati.com/tags/text" rel="tag">text</a>,<a href="http://technorati.com/tags/spaces" rel="tag">spaces</a>,<a href="http://technorati.com/tags/Also" rel="tag">Also</a>,<a href="http://technorati.com/tags/TestMethod" rel="tag">TestMethod</a>,<a href="http://technorati.com/tags/UsernameText_SetValue_ResultsInNewValue" rel="tag">UsernameText_SetValue_ResultsInNewValue</a>,<a href="http://technorati.com/tags/MainViewModel" rel="tag">MainViewModel</a>,<a href="http://technorati.com/tags/UsernameText" rel="tag">UsernameText</a>,<a href="http://technorati.com/tags/Assert" rel="tag">Assert</a>,<a href="http://technorati.com/tags/AreEqual" rel="tag">AreEqual</a>,<a href="http://technorati.com/tags/user" rel="tag">user</a>,<a href="http://technorati.com/tags/attention" rel="tag">attention</a>,<a href="http://technorati.com/tags/expose" rel="tag">expose</a>,<a href="http://technorati.com/tags/implementation" rel="tag">implementation</a>,<a href="http://technorati.com/tags/code" rel="tag">code</a>,<a href="http://technorati.com/tags/data" rel="tag">data</a>,<a href="http://technorati.com/tags/interface" rel="tag">interface</a>,<a href="http://technorati.com/tags/ICommand" rel="tag">ICommand</a>,<a href="http://technorati.com/tags/hook" rel="tag">hook</a>,<a href="http://technorati.com/tags/framework" rel="tag">framework</a>,<a href="http://technorati.com/tags/wire" rel="tag">wire</a>,<a href="http://technorati.com/tags/RelayCommand" rel="tag">RelayCommand</a>,<a href="http://technorati.com/tags/ExecuteLogin" rel="tag">ExecuteLogin</a>,<a href="http://technorati.com/tags/CanExecuteLogin" rel="tag">CanExecuteLogin</a>,<a href="http://technorati.com/tags/magazine" rel="tag">magazine</a>,<a href="http://technorati.com/tags/clients" rel="tag">clients</a>,<a href="http://technorati.com/tags/CanExecute" rel="tag">CanExecute</a>,<a href="http://technorati.com/tags/Execute" rel="tag">Execute</a>,<a href="http://technorati.com/tags/LoginCommand_ExecutedWithValidLogin_ResultsInSuccessfulLogin" rel="tag">LoginCommand_ExecutedWithValidLogin_ResultsInSuccessfulLogin</a>,<a href="http://technorati.com/tags/behaviour" rel="tag">behaviour</a>,<a href="http://technorati.com/tags/layer" rel="tag">layer</a>,<a href="http://technorati.com/tags/separation" rel="tag">separation</a>,<a href="http://technorati.com/tags/IUserRepository" rel="tag">IUserRepository</a>,<a href="http://technorati.com/tags/discussion" rel="tag">discussion</a>,<a href="http://technorati.com/tags/Login" rel="tag">Login</a>,<a href="http://technorati.com/tags/needs" rel="tag">needs</a>,<a href="http://technorati.com/tags/reference" rel="tag">reference</a>,<a href="http://technorati.com/tags/repository" rel="tag">repository</a>,<a href="http://technorati.com/tags/IsLoggedIn" rel="tag">IsLoggedIn</a>,<a href="http://technorati.com/tags/PasswordText" rel="tag">PasswordText</a>,<a href="http://technorati.com/tags/Where" rel="tag">Where</a>,<a href="http://technorati.com/tags/Back" rel="tag">Back</a>,<a href="http://technorati.com/tags/unit" rel="tag">unit</a>,<a href="http://technorati.com/tags/Fake" rel="tag">Fake</a>,<a href="http://technorati.com/tags/FakeUserRepository" rel="tag">FakeUserRepository</a>,<a href="http://technorati.com/tags/Func" rel="tag">Func</a>,<a href="http://technorati.com/tags/LoginAction" rel="tag">LoginAction</a>,<a href="http://technorati.com/tags/region" rel="tag">region</a>,<a href="http://technorati.com/tags/logic" rel="tag">logic</a>,<a href="http://technorati.com/tags/method" rel="tag">method</a>,<a href="http://technorati.com/tags/IsTrue" rel="tag">IsTrue</a>,<a href="http://technorati.com/tags/environment" rel="tag">environment</a>,<a href="http://technorati.com/tags/Test" rel="tag">Test</a>,<a href="http://technorati.com/tags/supports" rel="tag">supports</a>,<a href="http://technorati.com/tags/BackgroundWorker" rel="tag">BackgroundWorker</a>,<a href="http://technorati.com/tags/DoWork" rel="tag">DoWork</a>,<a href="http://technorati.com/tags/BackgroundWorkerDoWork" rel="tag">BackgroundWorkerDoWork</a>,<a href="http://technorati.com/tags/RunWorkerAsync" rel="tag">RunWorkerAsync</a>,<a href="http://technorati.com/tags/Userdata" rel="tag">Userdata</a>,<a href="http://technorati.com/tags/Username" rel="tag">Username</a>,<a href="http://technorati.com/tags/sender" rel="tag">sender</a>,<a href="http://technorati.com/tags/DoWorkEventArgs" rel="tag">DoWorkEventArgs</a>,<a href="http://technorati.com/tags/argument" rel="tag">argument</a>,<a href="http://technorati.com/tags/Result" rel="tag">Result</a>,<a href="http://technorati.com/tags/RunWorkerCompletedEventArgs" rel="tag">RunWorkerCompletedEventArgs</a>,<a href="http://technorati.com/tags/VisualStateManager" rel="tag">VisualStateManager</a>,<a href="http://technorati.com/tags/GoToState" rel="tag">GoToState</a>,<a href="http://technorati.com/tags/helper" rel="tag">helper</a>,<a href="http://technorati.com/tags/credentials" rel="tag">credentials</a>,<a href="http://technorati.com/tags/background" rel="tag">background</a>,<a href="http://technorati.com/tags/worker" rel="tag">worker</a>,<a href="http://technorati.com/tags/Asynchronous" rel="tag">Asynchronous</a>,<a href="http://technorati.com/tags/EnqueueConditional" rel="tag">EnqueueConditional</a>,<a href="http://technorati.com/tags/EnqueueCallback" rel="tag">EnqueueCallback</a>,<a href="http://technorati.com/tags/EnqueueTestComplete" rel="tag">EnqueueTestComplete</a>,<a href="http://technorati.com/tags/Enqueue" rel="tag">Enqueue</a>,<a href="http://technorati.com/tags/Sprinkle" rel="tag">Sprinkle</a>,<a href="http://technorati.com/tags/LoginCommand_ExecutedWithInValidLogin_ResultsInFailedLogin" rel="tag">LoginCommand_ExecutedWithInValidLogin_ResultsInFailedLogin</a>,<a href="http://technorati.com/tags/IsFalse" rel="tag">IsFalse</a>,<a href="http://technorati.com/tags/LoginCommand_CanExecuteReturnsTrue_GivenValidUsernameAndPassword" rel="tag">LoginCommand_CanExecuteReturnsTrue_GivenValidUsernameAndPassword</a>,<a href="http://technorati.com/tags/Results" rel="tag">Results</a>,<a href="http://technorati.com/tags/methods" rel="tag">methods</a>,<a href="http://technorati.com/tags/babaandthepigman" rel="tag">babaandthepigman</a>,<a href="http://technorati.com/tags/blog" rel="tag">blog</a>,<a href="http://technorati.com/tags/constructor" rel="tag">constructor</a>,<a href="http://technorati.com/tags/bool" rel="tag">bool</a>,<a href="http://technorati.com/tags/boolean" rel="tag">boolean</a><br />
<p></p>Windows Live Tags: <a href="http://windows.live.com/connect/tag/MVVM" rel="clubhouseTag">MVVM</a>,<a href="http://windows.live.com/connect/tag/Part" rel="clubhouseTag">Part</a>,<a href="http://windows.live.com/connect/tag/LoginCommand" rel="clubhouseTag">LoginCommand</a>,<a href="http://windows.live.com/connect/tag/password" rel="clubhouseTag">password</a>,<a href="http://windows.live.com/connect/tag/text" rel="clubhouseTag">text</a>,<a href="http://windows.live.com/connect/tag/spaces" rel="clubhouseTag">spaces</a>,<a href="http://windows.live.com/connect/tag/Also" rel="clubhouseTag">Also</a>,<a href="http://windows.live.com/connect/tag/TestMethod" rel="clubhouseTag">TestMethod</a>,<a href="http://windows.live.com/connect/tag/UsernameText_SetValue_ResultsInNewValue" rel="clubhouseTag">UsernameText_SetValue_ResultsInNewValue</a>,<a href="http://windows.live.com/connect/tag/MainViewModel" rel="clubhouseTag">MainViewModel</a>,<a href="http://windows.live.com/connect/tag/UsernameText" rel="clubhouseTag">UsernameText</a>,<a href="http://windows.live.com/connect/tag/Assert" rel="clubhouseTag">Assert</a>,<a href="http://windows.live.com/connect/tag/AreEqual" rel="clubhouseTag">AreEqual</a>,<a href="http://windows.live.com/connect/tag/user" rel="clubhouseTag">user</a>,<a href="http://windows.live.com/connect/tag/attention" rel="clubhouseTag">attention</a>,<a href="http://windows.live.com/connect/tag/expose" rel="clubhouseTag">expose</a>,<a href="http://windows.live.com/connect/tag/implementation" rel="clubhouseTag">implementation</a>,<a href="http://windows.live.com/connect/tag/code" rel="clubhouseTag">code</a>,<a href="http://windows.live.com/connect/tag/data" rel="clubhouseTag">data</a>,<a href="http://windows.live.com/connect/tag/interface" rel="clubhouseTag">interface</a>,<a href="http://windows.live.com/connect/tag/ICommand" rel="clubhouseTag">ICommand</a>,<a href="http://windows.live.com/connect/tag/hook" rel="clubhouseTag">hook</a>,<a href="http://windows.live.com/connect/tag/framework" rel="clubhouseTag">framework</a>,<a href="http://windows.live.com/connect/tag/wire" rel="clubhouseTag">wire</a>,<a href="http://windows.live.com/connect/tag/RelayCommand" rel="clubhouseTag">RelayCommand</a>,<a href="http://windows.live.com/connect/tag/ExecuteLogin" rel="clubhouseTag">ExecuteLogin</a>,<a href="http://windows.live.com/connect/tag/CanExecuteLogin" rel="clubhouseTag">CanExecuteLogin</a>,<a href="http://windows.live.com/connect/tag/magazine" rel="clubhouseTag">magazine</a>,<a href="http://windows.live.com/connect/tag/clients" rel="clubhouseTag">clients</a>,<a href="http://windows.live.com/connect/tag/CanExecute" rel="clubhouseTag">CanExecute</a>,<a href="http://windows.live.com/connect/tag/Execute" rel="clubhouseTag">Execute</a>,<a href="http://windows.live.com/connect/tag/LoginCommand_ExecutedWithValidLogin_ResultsInSuccessfulLogin" rel="clubhouseTag">LoginCommand_ExecutedWithValidLogin_ResultsInSuccessfulLogin</a>,<a href="http://windows.live.com/connect/tag/behaviour" rel="clubhouseTag">behaviour</a>,<a href="http://windows.live.com/connect/tag/layer" rel="clubhouseTag">layer</a>,<a href="http://windows.live.com/connect/tag/separation" rel="clubhouseTag">separation</a>,<a href="http://windows.live.com/connect/tag/IUserRepository" rel="clubhouseTag">IUserRepository</a>,<a href="http://windows.live.com/connect/tag/discussion" rel="clubhouseTag">discussion</a>,<a href="http://windows.live.com/connect/tag/Login" rel="clubhouseTag">Login</a>,<a href="http://windows.live.com/connect/tag/needs" rel="clubhouseTag">needs</a>,<a href="http://windows.live.com/connect/tag/reference" rel="clubhouseTag">reference</a>,<a href="http://windows.live.com/connect/tag/repository" rel="clubhouseTag">repository</a>,<a href="http://windows.live.com/connect/tag/IsLoggedIn" rel="clubhouseTag">IsLoggedIn</a>,<a href="http://windows.live.com/connect/tag/PasswordText" rel="clubhouseTag">PasswordText</a>,<a href="http://windows.live.com/connect/tag/Where" rel="clubhouseTag">Where</a>,<a href="http://windows.live.com/connect/tag/Back" rel="clubhouseTag">Back</a>,<a href="http://windows.live.com/connect/tag/unit" rel="clubhouseTag">unit</a>,<a href="http://windows.live.com/connect/tag/Fake" rel="clubhouseTag">Fake</a>,<a href="http://windows.live.com/connect/tag/FakeUserRepository" rel="clubhouseTag">FakeUserRepository</a>,<a href="http://windows.live.com/connect/tag/Func" rel="clubhouseTag">Func</a>,<a href="http://windows.live.com/connect/tag/LoginAction" rel="clubhouseTag">LoginAction</a>,<a href="http://windows.live.com/connect/tag/region" rel="clubhouseTag">region</a>,<a href="http://windows.live.com/connect/tag/logic" rel="clubhouseTag">logic</a>,<a href="http://windows.live.com/connect/tag/method" rel="clubhouseTag">method</a>,<a href="http://windows.live.com/connect/tag/IsTrue" rel="clubhouseTag">IsTrue</a>,<a href="http://windows.live.com/connect/tag/environment" rel="clubhouseTag">environment</a>,<a href="http://windows.live.com/connect/tag/Test" rel="clubhouseTag">Test</a>,<a href="http://windows.live.com/connect/tag/supports" rel="clubhouseTag">supports</a>,<a href="http://windows.live.com/connect/tag/BackgroundWorker" rel="clubhouseTag">BackgroundWorker</a>,<a href="http://windows.live.com/connect/tag/DoWork" rel="clubhouseTag">DoWork</a>,<a href="http://windows.live.com/connect/tag/BackgroundWorkerDoWork" rel="clubhouseTag">BackgroundWorkerDoWork</a>,<a href="http://windows.live.com/connect/tag/RunWorkerAsync" rel="clubhouseTag">RunWorkerAsync</a>,<a href="http://windows.live.com/connect/tag/Userdata" rel="clubhouseTag">Userdata</a>,<a href="http://windows.live.com/connect/tag/Username" rel="clubhouseTag">Username</a>,<a href="http://windows.live.com/connect/tag/sender" rel="clubhouseTag">sender</a>,<a href="http://windows.live.com/connect/tag/DoWorkEventArgs" rel="clubhouseTag">DoWorkEventArgs</a>,<a href="http://windows.live.com/connect/tag/argument" rel="clubhouseTag">argument</a>,<a href="http://windows.live.com/connect/tag/Result" rel="clubhouseTag">Result</a>,<a href="http://windows.live.com/connect/tag/RunWorkerCompletedEventArgs" rel="clubhouseTag">RunWorkerCompletedEventArgs</a>,<a href="http://windows.live.com/connect/tag/VisualStateManager" rel="clubhouseTag">VisualStateManager</a>,<a href="http://windows.live.com/connect/tag/GoToState" rel="clubhouseTag">GoToState</a>,<a href="http://windows.live.com/connect/tag/helper" rel="clubhouseTag">helper</a>,<a href="http://windows.live.com/connect/tag/credentials" rel="clubhouseTag">credentials</a>,<a href="http://windows.live.com/connect/tag/background" rel="clubhouseTag">background</a>,<a href="http://windows.live.com/connect/tag/worker" rel="clubhouseTag">worker</a>,<a href="http://windows.live.com/connect/tag/Asynchronous" rel="clubhouseTag">Asynchronous</a>,<a href="http://windows.live.com/connect/tag/EnqueueConditional" rel="clubhouseTag">EnqueueConditional</a>,<a href="http://windows.live.com/connect/tag/EnqueueCallback" rel="clubhouseTag">EnqueueCallback</a>,<a href="http://windows.live.com/connect/tag/EnqueueTestComplete" rel="clubhouseTag">EnqueueTestComplete</a>,<a href="http://windows.live.com/connect/tag/Enqueue" rel="clubhouseTag">Enqueue</a>,<a href="http://windows.live.com/connect/tag/Sprinkle" rel="clubhouseTag">Sprinkle</a>,<a href="http://windows.live.com/connect/tag/LoginCommand_ExecutedWithInValidLogin_ResultsInFailedLogin" rel="clubhouseTag">LoginCommand_ExecutedWithInValidLogin_ResultsInFailedLogin</a>,<a href="http://windows.live.com/connect/tag/IsFalse" rel="clubhouseTag">IsFalse</a>,<a href="http://windows.live.com/connect/tag/LoginCommand_CanExecuteReturnsTrue_GivenValidUsernameAndPassword" rel="clubhouseTag">LoginCommand_CanExecuteReturnsTrue_GivenValidUsernameAndPassword</a>,<a href="http://windows.live.com/connect/tag/Results" rel="clubhouseTag">Results</a>,<a href="http://windows.live.com/connect/tag/methods" rel="clubhouseTag">methods</a>,<a href="http://windows.live.com/connect/tag/babaandthepigman" rel="clubhouseTag">babaandthepigman</a>,<a href="http://windows.live.com/connect/tag/blog" rel="clubhouseTag">blog</a>,<a href="http://windows.live.com/connect/tag/constructor" rel="clubhouseTag">constructor</a>,<a href="http://windows.live.com/connect/tag/bool" rel="clubhouseTag">bool</a>,<a href="http://windows.live.com/connect/tag/boolean" rel="clubhouseTag">boolean</a>  </div>
