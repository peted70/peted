---
layout: post
title: WPF Commanding and Data Annotations Validation
date: 2010-02-14 20:48
author: peted70
comments: true
categories: [MVVM, WPF]
---
<div id="msgcns!4F1B7368284539E5!167" class="bvMsg"><p>by Peter Daukintis</p> <p>I recently ran into the need to create a simple WPF app with a data form front end and which should provide some simple validation feedback to the user. I thought this would be pretty straightforward using the WPF commanding support and Data Annotations to provide some simple validation metadata. I wanted to use an M-V-VM approach so that I could unit test my View Model code. This is a screenshot of the prototype app:</p> <p> </p> <blockquote> <p align="center"><a href="http://peted.azurewebsites.net/wp-content/uploads/2010/09/commandingscreen5b85d.png" rel="WLPP"><img style="display:inline;border-width:0;" title="CommandingScreen" border="0" alt="CommandingScreen" src="http://peted.azurewebsites.net/wp-content/uploads/2010/09/commandingscreen5b85d.png?w=300" width="551" height="348" /></a> </p> <p align="left"> </p></blockquote> <p>The save button should remain disabled until the fields have all been entered correctly and also some feedback should be available to the user about which field is preventing the validation as below.</p> <p> </p> <p align="center"><a href="http://peted.azurewebsites.net/wp-content/uploads/2010/09/commandingvalidation5b35d.png" rel="WLPP"><img style="display:inline;border-width:0;" title="CommandingValidation" border="0" alt="CommandingValidation" src="http://peted.azurewebsites.net/wp-content/uploads/2010/09/commandingvalidation5b35d.png?w=300" width="510" height="190" /></a> </p> <p> </p> <p>First I started by drawing on a few external resources; the Relay Command (see <a title="Relay Command" href="http://msdn.microsoft.com/en-us/magazine/dd419663.aspx" target="_blank">http://msdn.microsoft.com/en-us/magazine/dd419663.aspx</a>) from Josh Smith and I also used a type safe INotifyPropertyChanged extension method to save me from typos when using INPC.</p><pre> </pre><pre>    <span style="color:#eaeaac;">public static class </span><span style="color:#f0dfaf;">Extensions
    </span><span style="color:#d2d200;">&#123;
        </span><span style="color:#eaeaac;">public static void </span><span style="color:#f8ffc6;">Raise</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">this </span><span style="color:#2b91af;">PropertyChangedEventHandler </span><span style="color:#f8ffc6;">handler</span><span style="color:#d2d200;">, </span><span style="color:#f0dfaf;">Expression</span><span style="color:#d2d200;">&lt;</span><span style="color:#2b91af;">Func</span><span style="color:#d2d200;">&lt;</span><span style="color:#eaeaac;">object</span><span style="color:#d2d200;">, </span><span style="color:#eaeaac;">object</span><span style="color:#d2d200;">&gt;&gt; </span><span style="color:#f8ffc6;">x</span><span style="color:#d2d200;">)
        &#123;
            </span><span style="color:#eaeaac;">if </span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">handler </span><span style="color:#d2d200;">== </span><span style="color:#eaeaac;">null</span><span style="color:#d2d200;">) 
                </span><span style="color:#eaeaac;">return</span><span style="color:#d2d200;">;

            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">body </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">x</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Body </span><span style="color:#eaeaac;">as </span><span style="color:#f0dfaf;">MemberExpression</span><span style="color:#d2d200;">;
            </span><span style="color:#eaeaac;">if </span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">body </span><span style="color:#d2d200;">== </span><span style="color:#eaeaac;">null</span><span style="color:#d2d200;">)
                </span><span style="color:#eaeaac;">throw new </span><span style="color:#f0dfaf;">ArgumentException</span><span style="color:#d2d200;">(</span><span style="color:#c89191;">&quot;'x' should be a member expression&quot;</span><span style="color:#d2d200;">);

            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">vmExpression </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">body</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Expression </span><span style="color:#eaeaac;">as </span><span style="color:#f0dfaf;">ConstantExpression</span><span style="color:#d2d200;">;
            
            </span><span style="color:#eaeaac;">if </span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">vmExpression </span><span style="color:#d2d200;">== </span><span style="color:#eaeaac;">null</span><span style="color:#d2d200;">) 
                </span><span style="color:#eaeaac;">return</span><span style="color:#d2d200;">;

            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">vmlambda </span><span style="color:#d2d200;">= </span><span style="color:#f0dfaf;">Expression</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Lambda</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">vmExpression</span><span style="color:#d2d200;">);
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">vmFunc </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">vmlambda</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Compile</span><span style="color:#d2d200;">();
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">vm </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">vmFunc</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">DynamicInvoke</span><span style="color:#d2d200;">();

            </span><span style="color:#eaeaac;">string </span><span style="color:#f8ffc6;">propertyName </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">body</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Member</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Name</span><span style="color:#d2d200;">;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">e </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">PropertyChangedEventArgs</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">propertyName</span><span style="color:#d2d200;">);
            </span><span style="color:#f8ffc6;">handler</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">vm</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">e</span><span style="color:#d2d200;">);
        &#125; 
    &#125;
</span></pre><a href="http://11011.net/software/vspaste"></a>
<p>So, I began by creating my View Model class and binding it to the UI similar to the following:</p>
<blockquote><pre>    <span style="color:#eaeaac;">public class </span><span style="color:#f0dfaf;">ViewModel </span><span style="color:#d2d200;">: </span><span style="color:#2b91af;">INotifyPropertyChanged
    </span><span style="color:#d2d200;">&#123;
        </span><span style="color:#eaeaac;">public </span><span style="color:#2b91af;">ICommand </span><span style="color:#f8ffc6;">StoreCommand </span><span style="color:#d2d200;">&#123; </span><span style="color:#eaeaac;">get</span><span style="color:#d2d200;">; </span><span style="color:#eaeaac;">set</span><span style="color:#d2d200;">; &#125;
        </span><span style="color:#eaeaac;">public </span><span style="color:#2b91af;">ICommand </span><span style="color:#f8ffc6;">BrowseCommand </span><span style="color:#d2d200;">&#123; </span><span style="color:#eaeaac;">get</span><span style="color:#d2d200;">; </span><span style="color:#eaeaac;">set</span><span style="color:#d2d200;">; &#125;

        </span><span style="color:#eaeaac;">private string </span><span style="color:#f8ffc6;">_title </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">string</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Empty</span><span style="color:#d2d200;">;
</span><span style="color:#eaeaac;">        public string </span><span style="color:#f8ffc6;">Title
        </span><span style="color:#d2d200;">&#123;
            </span><span style="color:#eaeaac;">get </span><span style="color:#d2d200;">&#123; </span><span style="color:#eaeaac;">return </span><span style="color:#f8ffc6;">_title</span><span style="color:#d2d200;">; &#125;
            </span><span style="color:#eaeaac;">set
            </span><span style="color:#d2d200;">&#123;
                </span><span style="color:#eaeaac;">if </span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">_title </span><span style="color:#d2d200;">!= </span><span style="color:#eaeaac;">value</span><span style="color:#d2d200;">)
                &#123;
                    </span><span style="color:#f8ffc6;">_title </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">value</span><span style="color:#d2d200;">;
</span><span style="color:#d2d200;">                    </span><span style="color:#f8ffc6;">PropertyChanged</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Raise</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">t </span><span style="color:#d2d200;">=&gt; </span><span style="color:#f8ffc6;">Title</span><span style="color:#d2d200;">);
                &#125;
            &#125;
        &#125;
</span></pre></blockquote><a href="http://11011.net/software/vspaste"></a>
<p>The only code I had in my code-behind file was the following to databind the view model to the ui:</p>
<blockquote><pre><span style="color:#eaeaac;">public </span><span style="color:#f8ffc6;">MainWindow</span><span style="color:#d2d200;">()
&#123;
   </span><span style="color:#f8ffc6;">InitializeComponent</span><span style="color:#d2d200;">();
   </span><span style="color:#f8ffc6;">Loaded </span><span style="color:#d2d200;">+= </span><span style="color:#f8ffc6;">MainWindow_Loaded</span><span style="color:#d2d200;">;
&#125;

</span><span style="color:#eaeaac;">void </span><span style="color:#f8ffc6;">MainWindow_Loaded</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">object </span><span style="color:#f8ffc6;">sender</span><span style="color:#d2d200;">, </span><span style="color:#f0dfaf;">RoutedEventArgs </span><span style="color:#f8ffc6;">e</span><span style="color:#d2d200;">)
&#123;
    </span><span style="color:#f8ffc6;">DataContext </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">ViewModel</span><span style="color:#d2d200;">();
&#125;</span></pre></blockquote><a href="http://11011.net/software/vspaste"></a>
<p>So, I created two commands, store and browse, which I bound to the xaml like this:</p><pre>        <span style="color:#d2d200;">&lt;Button Content=</span><span style="color:white;">&quot;Save&quot; </span><span style="color:#d2d200;">Grid.Row=</span><span style="color:white;">&quot;5&quot; </span><span style="color:#d2d200;">HorizontalAlignment=</span><span style="color:white;">&quot;Right&quot; </span><span style="color:#d2d200;">Margin=</span><span style="color:white;">&quot;0,0,8,6&quot; </span><span style="color:#d2d200;">Name=</span><span style="color:white;">&quot;button1&quot; 
                </span><span style="color:#d2d200;">Width=</span><span style="color:white;">&quot;91&quot; </span><span style="color:#d2d200;">Height=</span><span style="color:white;">&quot;29&quot; 
                </span><span style="color:#d2d200;">VerticalAlignment=</span><span style="color:white;">&quot;Bottom&quot; </span><span style="color:#d2d200;">Grid.Column=</span><span style="color:white;">&quot;1&quot; </span><span style="color:#d2d200;">MinHeight=</span><span style="color:white;">&quot;20&quot;
                </span><span style="color:#d2d200;">Command=&quot;&#123;</span><span style="color:cyan;">Binding </span><span style="color:white;">Path</span><span style="color:#d2d200;">=</span><span style="color:lime;">StoreCommand</span><span style="color:#d2d200;">&#125;</span><span style="color:white;">&quot; </span><span style="color:#d2d200;">CommandParameter=&quot;&#123;</span><span style="color:cyan;">Binding</span><span style="color:#d2d200;">&#125;</span><span style="color:white;">&quot;</span><span style="color:#d2d200;">/&gt;

</span></pre><a href="http://11011.net/software/vspaste"></a>
<p></p>
<p></p>
<p>Now, using the Relay Command it is simple to wire up the commands to methods in my view model for Execute and canExecute:</p><pre>        <span style="color:#eaeaac;">public </span><span style="color:#f8ffc6;">ViewModel</span><span style="color:#d2d200;">()
        &#123;
            </span><span style="color:#f8ffc6;">StoreCommand </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">RelayCommand</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">ExecuteSave</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">CanExecuteSave</span><span style="color:#d2d200;">);
            </span><span style="color:#f8ffc6;">BrowseCommand </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">new </span><span style="color:#f0dfaf;">RelayCommand</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">ExecuteBrowse</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">CanExecuteBrowse</span><span style="color:#d2d200;">);
        &#125;
</span></pre>
<p>The main method here is CanExecuteSave since this will determine when my save button is enabled/disabled. So, in order for this method to return true I must have fully valid data. Although there are a few variations in how you approach validation in WPF it felt natural to me to try out using Data Annotations since I have used these for validation in Asp.Net MVC applications. These work by marking the data properties with attributes which are defined in the System.ComponentModel.DataAnnotations namespace. So, I just added a reference to this assembly and marked up my view model’s properties, like this:</p><pre>        <span style="color:#eaeaac;">private string </span><span style="color:#f8ffc6;">_artist </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">string</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Empty</span><span style="color:#d2d200;">;
        [</span><span style="color:#f0dfaf;">StringLength</span><span style="color:#d2d200;">(</span><span style="color:#8acccf;">50</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">MinimumLength </span><span style="color:#d2d200;">= </span><span style="color:#8acccf;">1</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">ErrorMessage </span><span style="color:#d2d200;">= </span><span style="color:#c89191;">&quot;Artist must be between 1 and 50 characters long.&quot;</span><span style="color:#d2d200;">)]
        </span><span style="color:#eaeaac;">public string </span><span style="color:#f8ffc6;">Artist
        </span><span style="color:#d2d200;">&#123;
            </span><span style="color:#eaeaac;">get </span><span style="color:#d2d200;">&#123; </span><span style="color:#eaeaac;">return </span><span style="color:#f8ffc6;">_artist</span><span style="color:#d2d200;">; &#125;
            </span><span style="color:#eaeaac;">set
            </span><span style="color:#d2d200;">&#123;
                </span><span style="color:#eaeaac;">if </span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">_artist </span><span style="color:#d2d200;">!= </span><span style="color:#eaeaac;">value</span><span style="color:#d2d200;">)
                &#123;
                    </span><span style="color:#f8ffc6;">_artist </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">value</span><span style="color:#d2d200;">;
</span><span style="color:#d2d200;">                    </span><span style="color:#f8ffc6;">PropertyChanged</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Raise</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">t </span><span style="color:#d2d200;">=&gt; </span><span style="color:#f8ffc6;">Artist</span><span style="color:#d2d200;">);
                &#125;
            &#125;
        &#125;

</span></pre>
<p>You can either use the provided attributes, such as StringLength, Required, etc. or you can provide a custom attribute as I did for validating the existence of a file.</p><pre>    <span style="color:#d2d200;">[</span><span style="color:#f0dfaf;">AttributeUsage</span><span style="color:#d2d200;">(</span><span style="color:#2b91af;">AttributeTargets</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Field </span><span style="color:#d2d200;">| </span><span style="color:#2b91af;">AttributeTargets</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Parameter </span><span style="color:#d2d200;">| </span><span style="color:#2b91af;">AttributeTargets</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Property</span><span style="color:#d2d200;">,
    </span><span style="color:#f8ffc6;">AllowMultiple </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">false</span><span style="color:#d2d200;">)]
    </span><span style="color:#eaeaac;">public class </span><span style="color:#f0dfaf;">FileExistsAttribute </span><span style="color:#d2d200;">: </span><span style="color:#f0dfaf;">ValidationAttribute
    </span><span style="color:#d2d200;">&#123;
        </span><span style="color:#eaeaac;">public override bool </span><span style="color:#f8ffc6;">IsValid</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">object </span><span style="color:#f8ffc6;">value</span><span style="color:#d2d200;">)
        &#123;
            </span><span style="color:#eaeaac;">return </span><span style="color:#f0dfaf;">File</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Exists</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">value </span><span style="color:#eaeaac;">as string</span><span style="color:#d2d200;">);            
        &#125;
    &#125;

</span></pre>
<p>Now, with the metadata in place my CanExecuteSave method can be implemented by reflecting over the attributes and calling the IsValid method on each one. This is achieved by calling the following method:</p><pre>    <span style="color:#eaeaac;">public static class </span><span style="color:#f0dfaf;">Validator
    </span><span style="color:#d2d200;">&#123;
        </span><span style="color:#eaeaac;">public static </span><span style="color:#2b91af;">IEnumerable</span><span style="color:#d2d200;">&lt;</span><span style="color:#f0dfaf;">ErrorInfo</span><span style="color:#d2d200;">&gt; </span><span style="color:#f8ffc6;">GetErrors</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">object </span><span style="color:#f8ffc6;">instance</span><span style="color:#d2d200;">)
        &#123;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">metadataAttrib </span><span style="color:#d2d200;">=
                </span><span style="color:#f8ffc6;">instance</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">GetType</span><span style="color:#d2d200;">().</span><span style="color:#f8ffc6;">GetCustomAttributes</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">typeof </span><span style="color:#d2d200;">(</span><span style="color:#f0dfaf;">MetadataTypeAttribute</span><span style="color:#d2d200;">), </span><span style="color:#eaeaac;">true</span><span style="color:#d2d200;">).</span><span style="color:#f8ffc6;">OfType
                    </span><span style="color:#d2d200;">&lt;</span><span style="color:#f0dfaf;">MetadataTypeAttribute</span><span style="color:#d2d200;">&gt;().</span><span style="color:#f8ffc6;">FirstOrDefault</span><span style="color:#d2d200;">();
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">buddyClassOrModelClass </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">metadataAttrib </span><span style="color:#d2d200;">!= </span><span style="color:#eaeaac;">null </span><span style="color:#d2d200;">? </span><span style="color:#f8ffc6;">metadataAttrib</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">MetadataClassType </span><span style="color:#d2d200;">: </span><span style="color:#f8ffc6;">instance</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">GetType</span><span style="color:#d2d200;">();
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">buddyClassProperties </span><span style="color:#d2d200;">= </span><span style="color:#f0dfaf;">TypeDescriptor</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">GetProperties</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">buddyClassOrModelClass</span><span style="color:#d2d200;">).</span><span style="color:#f8ffc6;">Cast</span><span style="color:#d2d200;">&lt;</span><span style="color:#f0dfaf;">PropertyDescriptor</span><span style="color:#d2d200;">&gt;();
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">modelClassProperties </span><span style="color:#d2d200;">= </span><span style="color:#f0dfaf;">TypeDescriptor</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">GetProperties</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">instance</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">GetType</span><span style="color:#d2d200;">()).</span><span style="color:#f8ffc6;">Cast</span><span style="color:#d2d200;">&lt;</span><span style="color:#f0dfaf;">PropertyDescriptor</span><span style="color:#d2d200;">&gt;();

            </span><span style="color:#eaeaac;">return from </span><span style="color:#f8ffc6;">buddyProp </span><span style="color:#eaeaac;">in </span><span style="color:#f8ffc6;">buddyClassProperties
                   </span><span style="color:#eaeaac;">join </span><span style="color:#f8ffc6;">modelProp </span><span style="color:#eaeaac;">in </span><span style="color:#f8ffc6;">modelClassProperties </span><span style="color:#eaeaac;">on </span><span style="color:#f8ffc6;">buddyProp</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Name </span><span style="color:#eaeaac;">equals </span><span style="color:#f8ffc6;">modelProp</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Name
                   </span><span style="color:#eaeaac;">from </span><span style="color:#f8ffc6;">attribute </span><span style="color:#eaeaac;">in </span><span style="color:#f8ffc6;">buddyProp</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Attributes</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">OfType</span><span style="color:#d2d200;">&lt;</span><span style="color:#f0dfaf;">ValidationAttribute</span><span style="color:#d2d200;">&gt;()
                   </span><span style="color:#eaeaac;">where </span><span style="color:#d2d200;">!</span><span style="color:#f8ffc6;">attribute</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">IsValid</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">modelProp</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">GetValue</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">instance</span><span style="color:#d2d200;">))
                   </span><span style="color:#eaeaac;">select new </span><span style="color:#f0dfaf;">ErrorInfo</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">buddyProp</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Name</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">attribute</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">FormatErrorMessage</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">string</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Empty</span><span style="color:#d2d200;">), </span><span style="color:#f8ffc6;">instance</span><span style="color:#d2d200;">);
        &#125;

</span></pre>
<p>And simply calling it,</p><pre>        <span style="color:#eaeaac;">public bool </span><span style="color:#f8ffc6;">CanExecuteSave</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">object </span><span style="color:#f8ffc6;">parameter</span><span style="color:#d2d200;">)
        &#123;
            </span><span style="color:#2b91af;">IEnumerable</span><span style="color:#d2d200;">&lt;</span><span style="color:#f0dfaf;">ErrorInfo</span><span style="color:#d2d200;">&gt; </span><span style="color:#f8ffc6;">errorInfos </span><span style="color:#d2d200;">= </span><span style="color:#f0dfaf;">Validator</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">GetErrors</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">this</span><span style="color:#d2d200;">);
            </span><span style="color:#eaeaac;">return </span><span style="color:#f8ffc6;">errorInfos</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Count</span><span style="color:#d2d200;">() &lt; </span><span style="color:#8acccf;">1</span><span style="color:#d2d200;">;
        &#125;

</span></pre>
<p>This takes care of enabling and disabling my Save button, so I just need to provide validation feedback for the data fields and I’m done. So, I need another static method on my Validator class:</p><pre>        <span style="color:#eaeaac;">public static </span><span style="color:#2b91af;">IEnumerable</span><span style="color:#d2d200;">&lt;</span><span style="color:#f0dfaf;">ErrorInfo</span><span style="color:#d2d200;">&gt; </span><span style="color:#f8ffc6;">GetErrors</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">object </span><span style="color:#f8ffc6;">instance</span><span style="color:#d2d200;">, </span><span style="color:#eaeaac;">string </span><span style="color:#f8ffc6;">property</span><span style="color:#d2d200;">, </span><span style="color:#eaeaac;">string </span><span style="color:#f8ffc6;">value</span><span style="color:#d2d200;">)
        &#123;
            </span><span style="color:#eaeaac;">var </span><span style="color:#f8ffc6;">info </span><span style="color:#d2d200;">= </span><span style="color:#f8ffc6;">instance</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">GetType</span><span style="color:#d2d200;">().</span><span style="color:#f8ffc6;">GetProperty</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">property</span><span style="color:#d2d200;">);
            </span><span style="color:#eaeaac;">return </span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">from </span><span style="color:#f8ffc6;">va </span><span style="color:#eaeaac;">in </span><span style="color:#f8ffc6;">info</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">GetCustomAttributes</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">true</span><span style="color:#d2d200;">).</span><span style="color:#f8ffc6;">OfType</span><span style="color:#d2d200;">&lt;</span><span style="color:#f0dfaf;">ValidationAttribute</span><span style="color:#d2d200;">&gt;()
                    </span><span style="color:#eaeaac;">where </span><span style="color:#d2d200;">!</span><span style="color:#f8ffc6;">va</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">IsValid</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">value</span><span style="color:#d2d200;">)
                    </span><span style="color:#eaeaac;">select new </span><span style="color:#f0dfaf;">ErrorInfo</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">property</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">va</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">FormatErrorMessage</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">string</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Empty</span><span style="color:#d2d200;">), </span><span style="color:#f8ffc6;">instance</span><span style="color:#d2d200;">)).</span><span style="color:#f8ffc6;">ToList</span><span style="color:#d2d200;">();
        &#125;

</span></pre>
<p>This I can call on a particular property and pass it an arbitrary value and it will return me an error report!</p>
<p>I wrapped a call to this up in a private method on the view model.</p><pre>        <span style="color:#eaeaac;">private void </span><span style="color:#f8ffc6;">ValidateProperty</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">string </span><span style="color:#f8ffc6;">value</span><span style="color:#d2d200;">, </span><span style="color:#eaeaac;">string </span><span style="color:#f8ffc6;">propertyName</span><span style="color:#d2d200;">)
        &#123;
            </span><span style="color:#2b91af;">IEnumerable</span><span style="color:#d2d200;">&lt;</span><span style="color:#f0dfaf;">ErrorInfo</span><span style="color:#d2d200;">&gt; </span><span style="color:#f8ffc6;">errorInfos </span><span style="color:#d2d200;">= </span><span style="color:#f0dfaf;">Validator</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">GetErrors</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">this</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">propertyName</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">value</span><span style="color:#d2d200;">);
            </span><span style="color:#eaeaac;">if </span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">errorInfos</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Count</span><span style="color:#d2d200;">() &gt; </span><span style="color:#8acccf;">0</span><span style="color:#d2d200;">)
            &#123;
                </span><span style="color:#eaeaac;">throw new </span><span style="color:#f0dfaf;">ApplicationException</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">errorInfos</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">First</span><span style="color:#d2d200;">().</span><span style="color:#f8ffc6;">FormatErrorMessage</span><span style="color:#d2d200;">);
            &#125;
        &#125;

</span></pre>
<p>And, insert a call to this inside each of my properties that I have annotated like the following:</p><pre>        <span style="color:#eaeaac;">private string </span><span style="color:#f8ffc6;">_title </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">string</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Empty</span><span style="color:#d2d200;">;
        [</span><span style="color:#f0dfaf;">StringLength</span><span style="color:#d2d200;">(</span><span style="color:#8acccf;">50</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">MinimumLength </span><span style="color:#d2d200;">= </span><span style="color:#8acccf;">1</span><span style="color:#d2d200;">, </span><span style="color:#f8ffc6;">ErrorMessage </span><span style="color:#d2d200;">= </span><span style="color:#c89191;">&quot;Title must be between 1 and 50 characters long.&quot;</span><span style="color:#d2d200;">)]
        </span><span style="color:#eaeaac;">public string </span><span style="color:#f8ffc6;">Title
        </span><span style="color:#d2d200;">&#123;
            </span><span style="color:#eaeaac;">get </span><span style="color:#d2d200;">&#123; </span><span style="color:#eaeaac;">return </span><span style="color:#f8ffc6;">_title</span><span style="color:#d2d200;">; &#125;
            </span><span style="color:#eaeaac;">set
            </span><span style="color:#d2d200;">&#123;

                </span><span style="color:#eaeaac;">if </span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">_title </span><span style="color:#d2d200;">!= </span><span style="color:#eaeaac;">value</span><span style="color:#d2d200;">)
                &#123;
                    </span><span style="color:#f8ffc6;">_title </span><span style="color:#d2d200;">= </span><span style="color:#eaeaac;">value</span><span style="color:#d2d200;">;
                    </span><span style="color:#f8ffc6;">ValidateProperty</span><span style="color:#d2d200;">(</span><span style="color:#eaeaac;">value</span><span style="color:#d2d200;">, </span><span style="color:#c89191;">&quot;Title&quot;</span><span style="color:#d2d200;">);
                    </span><span style="color:#f8ffc6;">PropertyChanged</span><span style="color:#d2d200;">.</span><span style="color:#f8ffc6;">Raise</span><span style="color:#d2d200;">(</span><span style="color:#f8ffc6;">t </span><span style="color:#d2d200;">=&gt; </span><span style="color:#f8ffc6;">Title</span><span style="color:#d2d200;">);
                &#125;
            &#125;
        &#125;

</span></pre>
<p>I don’t like the non-type-safe way I pass in the property name to the ValidateProperty call so in future I may use the same trick as for the Raise extension method, but for now…</p>
<p>A few more tweaks to the xaml and we’re done:</p><pre>        <span style="color:#d2d200;">&lt;TextBox Style=&quot;&#123;</span><span style="color:cyan;">StaticResource </span><span style="color:white;">ResourceKey</span><span style="color:#d2d200;">=</span><span style="color:lime;">textBoxStyle</span><span style="color:#d2d200;">&#125;</span><span style="color:white;">&quot; </span><span style="color:#d2d200;">Grid.Column=</span><span style="color:white;">&quot;1&quot; </span><span style="color:#d2d200;">Height=</span><span style="color:white;">&quot;23&quot; </span><span style="color:#d2d200;">HorizontalAlignment=</span><span style="color:white;">&quot;Stretch&quot;  </span><span style="color:#d2d200;">Name=</span><span style="color:white;">&quot;titleTextBox&quot; </span><span style="color:#d2d200;">VerticalAlignment=</span><span style="color:white;">&quot;Center&quot; </span><span style="color:#d2d200;">Margin=</span><span style="color:white;">&quot;6,13.5,8,13.5&quot;</span><span style="color:#d2d200;">&gt;
            &lt;TextBox.Text&gt;
                &lt;Binding Path=</span><span style="color:white;">&quot;Title&quot; </span><span style="color:#d2d200;">UpdateSourceTrigger=</span><span style="color:white;">&quot;PropertyChanged&quot; </span><span style="color:#d2d200;">NotifyOnValidationError=</span><span style="color:white;">&quot;True&quot;</span><span style="color:#d2d200;">&gt;
                    &lt;Binding.ValidationRules&gt;
                        &lt;ExceptionValidationRule /&gt;
                        </span><span style="color:silver;">&lt;!--&lt;source:RequiredRule /&gt;--&gt;
                    </span><span style="color:#d2d200;">&lt;/Binding.ValidationRules&gt;
                &lt;/Binding&gt;
            &lt;/TextBox.Text&gt;
        &lt;/TextBox&gt;

</span></pre>
<p>The ExceptionvalidationRule sets up the validation to respond to exceptions thrown in the property setter. Note, I had previously experimented with custom ValidationRule derived classes to provide the validation but I never got this to work as well for my scenario.</p>
<p>it just remains to define the textBoxStyle used as the style can be used to control the visual feedback given to the user:</p><pre>    <span style="color:#d2d200;">&lt;Window.Resources&gt;
        &lt;Style x:Key=</span><span style="color:white;">&quot;textBoxStyle&quot; </span><span style="color:#d2d200;">TargetType=&quot;&#123;</span><span style="color:cyan;">x</span><span style="color:#d2d200;">:</span><span style="color:cyan;">Type </span><span style="color:white;">TextBox</span><span style="color:#d2d200;">&#125;</span><span style="color:white;">&quot;</span><span style="color:#d2d200;">&gt;
            &lt;Setter Property=</span><span style="color:white;">&quot;FontSize&quot; </span><span style="color:#d2d200;">Value=</span><span style="color:white;">&quot;12&quot;</span><span style="color:#d2d200;">&gt;&lt;/Setter&gt;
            &lt;Style.Triggers&gt;
                &lt;Trigger Property=</span><span style="color:white;">&quot;Validation.HasError&quot; </span><span style="color:#d2d200;">Value=</span><span style="color:white;">&quot;true&quot;</span><span style="color:#d2d200;">&gt;
                    &lt;Setter Property=</span><span style="color:white;">&quot;ToolTip&quot; </span><span style="color:#d2d200;">Value=&quot;&#123;</span><span style="color:cyan;">Binding </span><span style="color:white;">RelativeSource</span><span style="color:#d2d200;">=&#123;</span><span style="color:cyan;">x</span><span style="color:#d2d200;">:</span><span style="color:cyan;">Static </span><span style="color:white;">RelativeSource</span><span style="color:#d2d200;">.</span><span style="color:lime;">Self</span><span style="color:#d2d200;">&#125;,
                            </span><span style="color:white;">Path</span><span style="color:#d2d200;">=(</span><span style="color:lime;">Validation</span><span style="color:#d2d200;">.</span><span style="color:lime;">Errors</span><span style="color:#d2d200;">)[0].</span><span style="color:lime;">ErrorContent</span><span style="color:#d2d200;">&#125;</span><span style="color:white;">&quot;</span><span style="color:#d2d200;">/&gt;
                &lt;/Trigger&gt;
            &lt;/Style.Triggers&gt;
        &lt;/Style&gt;
    &lt;/Window.Resources&gt;

</span></pre>
<p>And that is it!</p>
<p>Not quite as straightforward as I expected but the result is a pretty impressively flexible solution.</p>
<p></p>Technorati Tags: <a href="http://technorati.com/tags/Data" rel="tag">Data</a>,<a href="http://technorati.com/tags/Annotations" rel="tag">Annotations</a>,<a href="http://technorati.com/tags/Validation" rel="tag">Validation</a>,<a href="http://technorati.com/tags/feedback" rel="tag">feedback</a>,<a href="http://technorati.com/tags/user" rel="tag">user</a>,<a href="http://technorati.com/tags/unit" rel="tag">unit</a>,<a href="http://technorati.com/tags/View" rel="tag">View</a>,<a href="http://technorati.com/tags/Model" rel="tag">Model</a>,<a href="http://technorati.com/tags/code" rel="tag">code</a>,<a href="http://technorati.com/tags/prototype" rel="tag">prototype</a>,<a href="http://technorati.com/tags/Relay" rel="tag">Relay</a>,<a href="http://technorati.com/tags/Command" rel="tag">Command</a>,<a href="http://technorati.com/tags/magazine" rel="tag">magazine</a>,<a href="http://technorati.com/tags/Josh" rel="tag">Josh</a>,<a href="http://technorati.com/tags/Smith" rel="tag">Smith</a>,<a href="http://technorati.com/tags/extension" rel="tag">extension</a>,<a href="http://technorati.com/tags/method" rel="tag">method</a>,<a href="http://technorati.com/tags/INPC" rel="tag">INPC</a>,<a href="http://technorati.com/tags/Raise" rel="tag">Raise</a>,<a href="http://technorati.com/tags/PropertyChangedEventHandler" rel="tag">PropertyChangedEventHandler</a>,<a href="http://technorati.com/tags/handler" rel="tag">handler</a>,<a href="http://technorati.com/tags/Expression" rel="tag">Expression</a>,<a href="http://technorati.com/tags/Func" rel="tag">Func</a>,<a href="http://technorati.com/tags/Body" rel="tag">Body</a>,<a href="http://technorati.com/tags/MemberExpression" rel="tag">MemberExpression</a>,<a href="http://technorati.com/tags/ArgumentException" rel="tag">ArgumentException</a>,<a href="http://technorati.com/tags/member" rel="tag">member</a>,<a href="http://technorati.com/tags/ConstantExpression" rel="tag">ConstantExpression</a>,<a href="http://technorati.com/tags/Lambda" rel="tag">Lambda</a>,<a href="http://technorati.com/tags/Compile" rel="tag">Compile</a>,<a href="http://technorati.com/tags/Name" rel="tag">Name</a>,<a href="http://technorati.com/tags/PropertyChangedEventArgs" rel="tag">PropertyChangedEventArgs</a>,<a href="http://technorati.com/tags/ViewModel" rel="tag">ViewModel</a>,<a href="http://technorati.com/tags/ICommand" rel="tag">ICommand</a>,<a href="http://technorati.com/tags/StoreCommand" rel="tag">StoreCommand</a>,<a href="http://technorati.com/tags/BrowseCommand" rel="tag">BrowseCommand</a>,<a href="http://technorati.com/tags/_title" rel="tag">_title</a>,<a href="http://technorati.com/tags/Title" rel="tag">Title</a>,<a href="http://technorati.com/tags/InitializeComponent" rel="tag">InitializeComponent</a>,<a href="http://technorati.com/tags/sender" rel="tag">sender</a>,<a href="http://technorati.com/tags/RoutedEventArgs" rel="tag">RoutedEventArgs</a>,<a href="http://technorati.com/tags/DataContext" rel="tag">DataContext</a>,<a href="http://technorati.com/tags/commands" rel="tag">commands</a>,<a href="http://technorati.com/tags/Button" rel="tag">Button</a>,<a href="http://technorati.com/tags/Content" rel="tag">Content</a>,<a href="http://technorati.com/tags/Save" rel="tag">Save</a>,<a href="http://technorati.com/tags/Grid" rel="tag">Grid</a>,<a href="http://technorati.com/tags/HorizontalAlignment" rel="tag">HorizontalAlignment</a>,<a href="http://technorati.com/tags/Margin" rel="tag">Margin</a>,<a href="http://technorati.com/tags/Width" rel="tag">Width</a>,<a href="http://technorati.com/tags/VerticalAlignment" rel="tag">VerticalAlignment</a>,<a href="http://technorati.com/tags/Bottom" rel="tag">Bottom</a>,<a href="http://technorati.com/tags/Column" rel="tag">Column</a>,<a href="http://technorati.com/tags/Path" rel="tag">Path</a>,<a href="http://technorati.com/tags/CommandParameter" rel="tag">CommandParameter</a>,<a href="http://technorati.com/tags/wire" rel="tag">wire</a>,<a href="http://technorati.com/tags/Execute" rel="tag">Execute</a>,<a href="http://technorati.com/tags/RelayCommand" rel="tag">RelayCommand</a>,<a href="http://technorati.com/tags/ExecuteSave" rel="tag">ExecuteSave</a>,<a href="http://technorati.com/tags/CanExecuteSave" rel="tag">CanExecuteSave</a>,<a href="http://technorati.com/tags/ExecuteBrowse" rel="tag">ExecuteBrowse</a>,<a href="http://technorati.com/tags/CanExecuteBrowse" rel="tag">CanExecuteBrowse</a>,<a href="http://technorati.com/tags/Although" rel="tag">Although</a>,<a href="http://technorati.com/tags/System" rel="tag">System</a>,<a href="http://technorati.com/tags/ComponentModel" rel="tag">ComponentModel</a>,<a href="http://technorati.com/tags/DataAnnotations" rel="tag">DataAnnotations</a>,<a href="http://technorati.com/tags/reference" rel="tag">reference</a>,<a href="http://technorati.com/tags/_artist" rel="tag">_artist</a>,<a href="http://technorati.com/tags/StringLength" rel="tag">StringLength</a>,<a href="http://technorati.com/tags/MinimumLength" rel="tag">MinimumLength</a>,<a href="http://technorati.com/tags/ErrorMessage" rel="tag">ErrorMessage</a>,<a href="http://technorati.com/tags/Artist" rel="tag">Artist</a>,<a href="http://technorati.com/tags/characters" rel="tag">characters</a>,<a href="http://technorati.com/tags/custom" rel="tag">custom</a>,<a href="http://technorati.com/tags/existence" rel="tag">existence</a>,<a href="http://technorati.com/tags/AttributeUsage" rel="tag">AttributeUsage</a>,<a href="http://technorati.com/tags/AttributeTargets" rel="tag">AttributeTargets</a>,<a href="http://technorati.com/tags/Field" rel="tag">Field</a>,<a href="http://technorati.com/tags/Parameter" rel="tag">Parameter</a>,<a href="http://technorati.com/tags/AllowMultiple" rel="tag">AllowMultiple</a>,<a href="http://technorati.com/tags/FileExistsAttribute" rel="tag">FileExistsAttribute</a>,<a href="http://technorati.com/tags/ValidationAttribute" rel="tag">ValidationAttribute</a>,<a href="http://technorati.com/tags/IsValid" rel="tag">IsValid</a>,<a href="http://technorati.com/tags/File" rel="tag">File</a>,<a href="http://technorati.com/tags/Validator" rel="tag">Validator</a>,<a href="http://technorati.com/tags/IEnumerable" rel="tag">IEnumerable</a>,<a href="http://technorati.com/tags/ErrorInfo" rel="tag">ErrorInfo</a>,<a href="http://technorati.com/tags/GetErrors" rel="tag">GetErrors</a>,<a href="http://technorati.com/tags/instance" rel="tag">instance</a>,<a href="http://technorati.com/tags/GetType" rel="tag">GetType</a>,<a href="http://technorati.com/tags/GetCustomAttributes" rel="tag">GetCustomAttributes</a>,<a href="http://technorati.com/tags/MetadataTypeAttribute" rel="tag">MetadataTypeAttribute</a>,<a href="http://technorati.com/tags/OfType" rel="tag">OfType</a>,<a href="http://technorati.com/tags/FirstOrDefault" rel="tag">FirstOrDefault</a>,<a href="http://technorati.com/tags/MetadataClassType" rel="tag">MetadataClassType</a>,<a href="http://technorati.com/tags/TypeDescriptor" rel="tag">TypeDescriptor</a>,<a href="http://technorati.com/tags/GetProperties" rel="tag">GetProperties</a>,<a href="http://technorati.com/tags/Cast" rel="tag">Cast</a>,<a href="http://technorati.com/tags/PropertyDescriptor" rel="tag">PropertyDescriptor</a>,<a href="http://technorati.com/tags/equals" rel="tag">equals</a>,<a href="http://technorati.com/tags/GetValue" rel="tag">GetValue</a>,<a href="http://technorati.com/tags/FormatErrorMessage" rel="tag">FormatErrorMessage</a>,<a href="http://technorati.com/tags/Count" rel="tag">Count</a>,<a href="http://technorati.com/tags/info" rel="tag">info</a>,<a href="http://technorati.com/tags/ToList" rel="tag">ToList</a>,<a href="http://technorati.com/tags/error" rel="tag">error</a>,<a href="http://technorati.com/tags/ApplicationException" rel="tag">ApplicationException</a>,<a href="http://technorati.com/tags/TextBox" rel="tag">TextBox</a>,<a href="http://technorati.com/tags/Style" rel="tag">Style</a>,<a href="http://technorati.com/tags/StaticResource" rel="tag">StaticResource</a>,<a href="http://technorati.com/tags/ResourceKey" rel="tag">ResourceKey</a>,<a href="http://technorati.com/tags/Stretch" rel="tag">Stretch</a>,<a href="http://technorati.com/tags/Center" rel="tag">Center</a>,<a href="http://technorati.com/tags/Text" rel="tag">Text</a>,<a href="http://technorati.com/tags/UpdateSourceTrigger" rel="tag">UpdateSourceTrigger</a>,<a href="http://technorati.com/tags/NotifyOnValidationError" rel="tag">NotifyOnValidationError</a>,<a href="http://technorati.com/tags/True" rel="tag">True</a>,<a href="http://technorati.com/tags/ValidationRules" rel="tag">ValidationRules</a>,<a href="http://technorati.com/tags/ExceptionValidationRule" rel="tag">ExceptionValidationRule</a>,<a href="http://technorati.com/tags/RequiredRule" rel="tag">RequiredRule</a>,<a href="http://technorati.com/tags/Note" rel="tag">Note</a>,<a href="http://technorati.com/tags/ValidationRule" rel="tag">ValidationRule</a>,<a href="http://technorati.com/tags/classes" rel="tag">classes</a>,<a href="http://technorati.com/tags/scenario" rel="tag">scenario</a>,<a href="http://technorati.com/tags/Resources" rel="tag">Resources</a>,<a href="http://technorati.com/tags/TargetType" rel="tag">TargetType</a>,<a href="http://technorati.com/tags/Type" rel="tag">Type</a>,<a href="http://technorati.com/tags/Setter" rel="tag">Setter</a>,<a href="http://technorati.com/tags/FontSize" rel="tag">FontSize</a>,<a href="http://technorati.com/tags/Value" rel="tag">Value</a>,<a href="http://technorati.com/tags/Trigger" rel="tag">Trigger</a>,<a href="http://technorati.com/tags/HasError" rel="tag">HasError</a>,<a href="http://technorati.com/tags/ToolTip" rel="tag">ToolTip</a>,<a href="http://technorati.com/tags/RelativeSource" rel="tag">RelativeSource</a>,<a href="http://technorati.com/tags/Static" rel="tag">Static</a>,<a href="http://technorati.com/tags/Self" rel="tag">Self</a>,<a href="http://technorati.com/tags/ErrorContent" rel="tag">ErrorContent</a>,<a href="http://technorati.com/tags/result" rel="tag">result</a>,<a href="http://technorati.com/tags/solution" rel="tag">solution</a>,<a href="http://technorati.com/tags/Extensions" rel="tag">Extensions</a>,<a href="http://technorati.com/tags/methods" rel="tag">methods</a>,<a href="http://technorati.com/tags/variations" rel="tag">variations</a>,<a href="http://technorati.com/tags/Errors" rel="tag">Errors</a>,<a href="http://technorati.com/tags/metadata" rel="tag">metadata</a>,<a href="http://technorati.com/tags/vmExpression" rel="tag">vmExpression</a>,<a href="http://technorati.com/tags/vmlambda" rel="tag">vmlambda</a>,<a href="http://technorati.com/tags/vmFunc" rel="tag">vmFunc</a>,<a href="http://technorati.com/tags/propertyName" rel="tag">propertyName</a>,<a href="http://technorati.com/tags/xaml" rel="tag">xaml</a>,<a href="http://technorati.com/tags/bool" rel="tag">bool</a>,<a href="http://technorati.com/tags/metadataAttrib" rel="tag">metadataAttrib</a>,<a href="http://technorati.com/tags/buddyClassOrModelClass" rel="tag">buddyClassOrModelClass</a>,<a href="http://technorati.com/tags/buddyClassProperties" rel="tag">buddyClassProperties</a>,<a href="http://technorati.com/tags/modelClassProperties" rel="tag">modelClassProperties</a>,<a href="http://technorati.com/tags/buddyProp" rel="tag">buddyProp</a>,<a href="http://technorati.com/tags/modelProp" rel="tag">modelProp</a>,<a href="http://technorati.com/tags/errorInfos" rel="tag">errorInfos</a>,<a href="http://technorati.com/tags/textBoxStyle" rel="tag">textBoxStyle</a><br />
<p></p>Windows Live Tags: <a href="http://windows.live.com/connect/tag/Data" rel="clubhouseTag">Data</a>,<a href="http://windows.live.com/connect/tag/Annotations" rel="clubhouseTag">Annotations</a>,<a href="http://windows.live.com/connect/tag/Validation" rel="clubhouseTag">Validation</a>,<a href="http://windows.live.com/connect/tag/feedback" rel="clubhouseTag">feedback</a>,<a href="http://windows.live.com/connect/tag/user" rel="clubhouseTag">user</a>,<a href="http://windows.live.com/connect/tag/unit" rel="clubhouseTag">unit</a>,<a href="http://windows.live.com/connect/tag/View" rel="clubhouseTag">View</a>,<a href="http://windows.live.com/connect/tag/Model" rel="clubhouseTag">Model</a>,<a href="http://windows.live.com/connect/tag/code" rel="clubhouseTag">code</a>,<a href="http://windows.live.com/connect/tag/prototype" rel="clubhouseTag">prototype</a>,<a href="http://windows.live.com/connect/tag/Relay" rel="clubhouseTag">Relay</a>,<a href="http://windows.live.com/connect/tag/Command" rel="clubhouseTag">Command</a>,<a href="http://windows.live.com/connect/tag/magazine" rel="clubhouseTag">magazine</a>,<a href="http://windows.live.com/connect/tag/Josh" rel="clubhouseTag">Josh</a>,<a href="http://windows.live.com/connect/tag/Smith" rel="clubhouseTag">Smith</a>,<a href="http://windows.live.com/connect/tag/extension" rel="clubhouseTag">extension</a>,<a href="http://windows.live.com/connect/tag/method" rel="clubhouseTag">method</a>,<a href="http://windows.live.com/connect/tag/INPC" rel="clubhouseTag">INPC</a>,<a href="http://windows.live.com/connect/tag/Raise" rel="clubhouseTag">Raise</a>,<a href="http://windows.live.com/connect/tag/PropertyChangedEventHandler" rel="clubhouseTag">PropertyChangedEventHandler</a>,<a href="http://windows.live.com/connect/tag/handler" rel="clubhouseTag">handler</a>,<a href="http://windows.live.com/connect/tag/Expression" rel="clubhouseTag">Expression</a>,<a href="http://windows.live.com/connect/tag/Func" rel="clubhouseTag">Func</a>,<a href="http://windows.live.com/connect/tag/Body" rel="clubhouseTag">Body</a>,<a href="http://windows.live.com/connect/tag/MemberExpression" rel="clubhouseTag">MemberExpression</a>,<a href="http://windows.live.com/connect/tag/ArgumentException" rel="clubhouseTag">ArgumentException</a>,<a href="http://windows.live.com/connect/tag/member" rel="clubhouseTag">member</a>,<a href="http://windows.live.com/connect/tag/ConstantExpression" rel="clubhouseTag">ConstantExpression</a>,<a href="http://windows.live.com/connect/tag/Lambda" rel="clubhouseTag">Lambda</a>,<a href="http://windows.live.com/connect/tag/Compile" rel="clubhouseTag">Compile</a>,<a href="http://windows.live.com/connect/tag/Name" rel="clubhouseTag">Name</a>,<a href="http://windows.live.com/connect/tag/PropertyChangedEventArgs" rel="clubhouseTag">PropertyChangedEventArgs</a>,<a href="http://windows.live.com/connect/tag/ViewModel" rel="clubhouseTag">ViewModel</a>,<a href="http://windows.live.com/connect/tag/ICommand" rel="clubhouseTag">ICommand</a>,<a href="http://windows.live.com/connect/tag/StoreCommand" rel="clubhouseTag">StoreCommand</a>,<a href="http://windows.live.com/connect/tag/BrowseCommand" rel="clubhouseTag">BrowseCommand</a>,<a href="http://windows.live.com/connect/tag/_title" rel="clubhouseTag">_title</a>,<a href="http://windows.live.com/connect/tag/Title" rel="clubhouseTag">Title</a>,<a href="http://windows.live.com/connect/tag/InitializeComponent" rel="clubhouseTag">InitializeComponent</a>,<a href="http://windows.live.com/connect/tag/sender" rel="clubhouseTag">sender</a>,<a href="http://windows.live.com/connect/tag/RoutedEventArgs" rel="clubhouseTag">RoutedEventArgs</a>,<a href="http://windows.live.com/connect/tag/DataContext" rel="clubhouseTag">DataContext</a>,<a href="http://windows.live.com/connect/tag/commands" rel="clubhouseTag">commands</a>,<a href="http://windows.live.com/connect/tag/Button" rel="clubhouseTag">Button</a>,<a href="http://windows.live.com/connect/tag/Content" rel="clubhouseTag">Content</a>,<a href="http://windows.live.com/connect/tag/Save" rel="clubhouseTag">Save</a>,<a href="http://windows.live.com/connect/tag/Grid" rel="clubhouseTag">Grid</a>,<a href="http://windows.live.com/connect/tag/HorizontalAlignment" rel="clubhouseTag">HorizontalAlignment</a>,<a href="http://windows.live.com/connect/tag/Margin" rel="clubhouseTag">Margin</a>,<a href="http://windows.live.com/connect/tag/Width" rel="clubhouseTag">Width</a>,<a href="http://windows.live.com/connect/tag/VerticalAlignment" rel="clubhouseTag">VerticalAlignment</a>,<a href="http://windows.live.com/connect/tag/Bottom" rel="clubhouseTag">Bottom</a>,<a href="http://windows.live.com/connect/tag/Column" rel="clubhouseTag">Column</a>,<a href="http://windows.live.com/connect/tag/Path" rel="clubhouseTag">Path</a>,<a href="http://windows.live.com/connect/tag/CommandParameter" rel="clubhouseTag">CommandParameter</a>,<a href="http://windows.live.com/connect/tag/wire" rel="clubhouseTag">wire</a>,<a href="http://windows.live.com/connect/tag/Execute" rel="clubhouseTag">Execute</a>,<a href="http://windows.live.com/connect/tag/RelayCommand" rel="clubhouseTag">RelayCommand</a>,<a href="http://windows.live.com/connect/tag/ExecuteSave" rel="clubhouseTag">ExecuteSave</a>,<a href="http://windows.live.com/connect/tag/CanExecuteSave" rel="clubhouseTag">CanExecuteSave</a>,<a href="http://windows.live.com/connect/tag/ExecuteBrowse" rel="clubhouseTag">ExecuteBrowse</a>,<a href="http://windows.live.com/connect/tag/CanExecuteBrowse" rel="clubhouseTag">CanExecuteBrowse</a>,<a href="http://windows.live.com/connect/tag/Although" rel="clubhouseTag">Although</a>,<a href="http://windows.live.com/connect/tag/System" rel="clubhouseTag">System</a>,<a href="http://windows.live.com/connect/tag/ComponentModel" rel="clubhouseTag">ComponentModel</a>,<a href="http://windows.live.com/connect/tag/DataAnnotations" rel="clubhouseTag">DataAnnotations</a>,<a href="http://windows.live.com/connect/tag/reference" rel="clubhouseTag">reference</a>,<a href="http://windows.live.com/connect/tag/_artist" rel="clubhouseTag">_artist</a>,<a href="http://windows.live.com/connect/tag/StringLength" rel="clubhouseTag">StringLength</a>,<a href="http://windows.live.com/connect/tag/MinimumLength" rel="clubhouseTag">MinimumLength</a>,<a href="http://windows.live.com/connect/tag/ErrorMessage" rel="clubhouseTag">ErrorMessage</a>,<a href="http://windows.live.com/connect/tag/Artist" rel="clubhouseTag">Artist</a>,<a href="http://windows.live.com/connect/tag/characters" rel="clubhouseTag">characters</a>,<a href="http://windows.live.com/connect/tag/custom" rel="clubhouseTag">custom</a>,<a href="http://windows.live.com/connect/tag/existence" rel="clubhouseTag">existence</a>,<a href="http://windows.live.com/connect/tag/AttributeUsage" rel="clubhouseTag">AttributeUsage</a>,<a href="http://windows.live.com/connect/tag/AttributeTargets" rel="clubhouseTag">AttributeTargets</a>,<a href="http://windows.live.com/connect/tag/Field" rel="clubhouseTag">Field</a>,<a href="http://windows.live.com/connect/tag/Parameter" rel="clubhouseTag">Parameter</a>,<a href="http://windows.live.com/connect/tag/AllowMultiple" rel="clubhouseTag">AllowMultiple</a>,<a href="http://windows.live.com/connect/tag/FileExistsAttribute" rel="clubhouseTag">FileExistsAttribute</a>,<a href="http://windows.live.com/connect/tag/ValidationAttribute" rel="clubhouseTag">ValidationAttribute</a>,<a href="http://windows.live.com/connect/tag/IsValid" rel="clubhouseTag">IsValid</a>,<a href="http://windows.live.com/connect/tag/File" rel="clubhouseTag">File</a>,<a href="http://windows.live.com/connect/tag/Validator" rel="clubhouseTag">Validator</a>,<a href="http://windows.live.com/connect/tag/IEnumerable" rel="clubhouseTag">IEnumerable</a>,<a href="http://windows.live.com/connect/tag/ErrorInfo" rel="clubhouseTag">ErrorInfo</a>,<a href="http://windows.live.com/connect/tag/GetErrors" rel="clubhouseTag">GetErrors</a>,<a href="http://windows.live.com/connect/tag/instance" rel="clubhouseTag">instance</a>,<a href="http://windows.live.com/connect/tag/GetType" rel="clubhouseTag">GetType</a>,<a href="http://windows.live.com/connect/tag/GetCustomAttributes" rel="clubhouseTag">GetCustomAttributes</a>,<a href="http://windows.live.com/connect/tag/MetadataTypeAttribute" rel="clubhouseTag">MetadataTypeAttribute</a>,<a href="http://windows.live.com/connect/tag/OfType" rel="clubhouseTag">OfType</a>,<a href="http://windows.live.com/connect/tag/FirstOrDefault" rel="clubhouseTag">FirstOrDefault</a>,<a href="http://windows.live.com/connect/tag/MetadataClassType" rel="clubhouseTag">MetadataClassType</a>,<a href="http://windows.live.com/connect/tag/TypeDescriptor" rel="clubhouseTag">TypeDescriptor</a>,<a href="http://windows.live.com/connect/tag/GetProperties" rel="clubhouseTag">GetProperties</a>,<a href="http://windows.live.com/connect/tag/Cast" rel="clubhouseTag">Cast</a>,<a href="http://windows.live.com/connect/tag/PropertyDescriptor" rel="clubhouseTag">PropertyDescriptor</a>,<a href="http://windows.live.com/connect/tag/equals" rel="clubhouseTag">equals</a>,<a href="http://windows.live.com/connect/tag/GetValue" rel="clubhouseTag">GetValue</a>,<a href="http://windows.live.com/connect/tag/FormatErrorMessage" rel="clubhouseTag">FormatErrorMessage</a>,<a href="http://windows.live.com/connect/tag/Count" rel="clubhouseTag">Count</a>,<a href="http://windows.live.com/connect/tag/info" rel="clubhouseTag">info</a>,<a href="http://windows.live.com/connect/tag/ToList" rel="clubhouseTag">ToList</a>,<a href="http://windows.live.com/connect/tag/error" rel="clubhouseTag">error</a>,<a href="http://windows.live.com/connect/tag/ApplicationException" rel="clubhouseTag">ApplicationException</a>,<a href="http://windows.live.com/connect/tag/TextBox" rel="clubhouseTag">TextBox</a>,<a href="http://windows.live.com/connect/tag/Style" rel="clubhouseTag">Style</a>,<a href="http://windows.live.com/connect/tag/StaticResource" rel="clubhouseTag">StaticResource</a>,<a href="http://windows.live.com/connect/tag/ResourceKey" rel="clubhouseTag">ResourceKey</a>,<a href="http://windows.live.com/connect/tag/Stretch" rel="clubhouseTag">Stretch</a>,<a href="http://windows.live.com/connect/tag/Center" rel="clubhouseTag">Center</a>,<a href="http://windows.live.com/connect/tag/Text" rel="clubhouseTag">Text</a>,<a href="http://windows.live.com/connect/tag/UpdateSourceTrigger" rel="clubhouseTag">UpdateSourceTrigger</a>,<a href="http://windows.live.com/connect/tag/NotifyOnValidationError" rel="clubhouseTag">NotifyOnValidationError</a>,<a href="http://windows.live.com/connect/tag/True" rel="clubhouseTag">True</a>,<a href="http://windows.live.com/connect/tag/ValidationRules" rel="clubhouseTag">ValidationRules</a>,<a href="http://windows.live.com/connect/tag/ExceptionValidationRule" rel="clubhouseTag">ExceptionValidationRule</a>,<a href="http://windows.live.com/connect/tag/RequiredRule" rel="clubhouseTag">RequiredRule</a>,<a href="http://windows.live.com/connect/tag/Note" rel="clubhouseTag">Note</a>,<a href="http://windows.live.com/connect/tag/ValidationRule" rel="clubhouseTag">ValidationRule</a>,<a href="http://windows.live.com/connect/tag/classes" rel="clubhouseTag">classes</a>,<a href="http://windows.live.com/connect/tag/scenario" rel="clubhouseTag">scenario</a>,<a href="http://windows.live.com/connect/tag/Resources" rel="clubhouseTag">Resources</a>,<a href="http://windows.live.com/connect/tag/TargetType" rel="clubhouseTag">TargetType</a>,<a href="http://windows.live.com/connect/tag/Type" rel="clubhouseTag">Type</a>,<a href="http://windows.live.com/connect/tag/Setter" rel="clubhouseTag">Setter</a>,<a href="http://windows.live.com/connect/tag/FontSize" rel="clubhouseTag">FontSize</a>,<a href="http://windows.live.com/connect/tag/Value" rel="clubhouseTag">Value</a>,<a href="http://windows.live.com/connect/tag/Trigger" rel="clubhouseTag">Trigger</a>,<a href="http://windows.live.com/connect/tag/HasError" rel="clubhouseTag">HasError</a>,<a href="http://windows.live.com/connect/tag/ToolTip" rel="clubhouseTag">ToolTip</a>,<a href="http://windows.live.com/connect/tag/RelativeSource" rel="clubhouseTag">RelativeSource</a>,<a href="http://windows.live.com/connect/tag/Static" rel="clubhouseTag">Static</a>,<a href="http://windows.live.com/connect/tag/Self" rel="clubhouseTag">Self</a>,<a href="http://windows.live.com/connect/tag/ErrorContent" rel="clubhouseTag">ErrorContent</a>,<a href="http://windows.live.com/connect/tag/result" rel="clubhouseTag">result</a>,<a href="http://windows.live.com/connect/tag/solution" rel="clubhouseTag">solution</a>,<a href="http://windows.live.com/connect/tag/Extensions" rel="clubhouseTag">Extensions</a>,<a href="http://windows.live.com/connect/tag/methods" rel="clubhouseTag">methods</a>,<a href="http://windows.live.com/connect/tag/variations" rel="clubhouseTag">variations</a>,<a href="http://windows.live.com/connect/tag/Errors" rel="clubhouseTag">Errors</a>,<a href="http://windows.live.com/connect/tag/metadata" rel="clubhouseTag">metadata</a>,<a href="http://windows.live.com/connect/tag/vmExpression" rel="clubhouseTag">vmExpression</a>,<a href="http://windows.live.com/connect/tag/vmlambda" rel="clubhouseTag">vmlambda</a>,<a href="http://windows.live.com/connect/tag/vmFunc" rel="clubhouseTag">vmFunc</a>,<a href="http://windows.live.com/connect/tag/propertyName" rel="clubhouseTag">propertyName</a>,<a href="http://windows.live.com/connect/tag/xaml" rel="clubhouseTag">xaml</a>,<a href="http://windows.live.com/connect/tag/bool" rel="clubhouseTag">bool</a>,<a href="http://windows.live.com/connect/tag/metadataAttrib" rel="clubhouseTag">metadataAttrib</a>,<a href="http://windows.live.com/connect/tag/buddyClassOrModelClass" rel="clubhouseTag">buddyClassOrModelClass</a>,<a href="http://windows.live.com/connect/tag/buddyClassProperties" rel="clubhouseTag">buddyClassProperties</a>,<a href="http://windows.live.com/connect/tag/modelClassProperties" rel="clubhouseTag">modelClassProperties</a>,<a href="http://windows.live.com/connect/tag/buddyProp" rel="clubhouseTag">buddyProp</a>,<a href="http://windows.live.com/connect/tag/modelProp" rel="clubhouseTag">modelProp</a>,<a href="http://windows.live.com/connect/tag/errorInfos" rel="clubhouseTag">errorInfos</a>,<a href="http://windows.live.com/connect/tag/textBoxStyle" rel="clubhouseTag">textBoxStyle</a>  </div>
