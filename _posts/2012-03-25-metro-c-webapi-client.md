---
layout: single
title: metro c# webapi client
date: 2012-03-25 18:37
author_profile: true
comments: true
categories: [asp.net web api, c#, consumer preview, Expression Blend, expression blend, Metro, metro, Windows 8, WinRT, winrt]
header:
    teaserlogo: 'assets/images/'
    teaser: 'assets/images/'
---
<p>Peter Daukintis</p>  <p>For my own purposes I wanted to create a test application which I can use as a test-bed to experiment with user interface aspects of Metro. I decided to create a simple REST web service and make create/read/update/delete type calls to it from a c# metro application. Pretty much the next step up from ‘Hello World’ for a web connected application.</p>  <p>First, to create the Web API choose ASP.NET MVC 4 Application from the New Project Dialog and in the ensuing dialog select WebApi. We are using the ASP.NET MVC 4 Beta which now includes the WebApi (<a title="http://www.asp.net/web-api" href="http://www.asp.net/web-api">http://www.asp.net/web-api</a>); which was formerly known as WCF WebApi.</p>  <p>The template creates a ValuesController to expose the sample CRUD methods (GetCollection/Get/Post/Put/Delete). It uses a string as the payload so I’m going to change that to use a Person class.</p>  <div style="margin:0;display:inline;float:none;padding:0;" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:f0e4409b-8685-4cfb-ace4-cbbe56f59d69" class="wlWriterEditableSmartContent"> <div style="border:#000080 1px solid;color:#000;font-family:'Courier New', Courier, Monospace;font-size:10pt;"> <div style="background-color:#000000;overflow:auto;padding:2px 5px;"><span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">class</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">static</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">int</span><span style="background:#1e1e1e;color:#c8c8c8;"> idGen </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#b5cea8;">123456</span><span style="background:#1e1e1e;color:#c8c8c8;">;</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> Person()</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;">Id </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#9b9b9b;">++</span><span style="background:#1e1e1e;color:#c8c8c8;">idGen;</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">}</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> Person(</span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#c8c8c8;"> other)</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;">Id </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> other</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Id;</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;">Name </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> other</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Name;</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;">Occupation </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> other</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Occupation;</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">}</span><br> <br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">string</span><span style="background:#1e1e1e;color:#c8c8c8;"> Occupation { </span><span style="background:#1e1e1e;color:#569cd6;">get</span><span style="background:#1e1e1e;color:#c8c8c8;">; </span><span style="background:#1e1e1e;color:#569cd6;">set</span><span style="background:#1e1e1e;color:#c8c8c8;">; }</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">string</span><span style="background:#1e1e1e;color:#c8c8c8;"> Name { </span><span style="background:#1e1e1e;color:#569cd6;">get</span><span style="background:#1e1e1e;color:#c8c8c8;">; </span><span style="background:#1e1e1e;color:#569cd6;">set</span><span style="background:#1e1e1e;color:#c8c8c8;">; }</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">int</span><span style="background:#1e1e1e;color:#c8c8c8;"> Id { </span><span style="background:#1e1e1e;color:#569cd6;">get</span><span style="background:#1e1e1e;color:#c8c8c8;">; </span><span style="background:#1e1e1e;color:#569cd6;">private</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">set</span><span style="background:#1e1e1e;color:#c8c8c8;">; }</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">}</span></div> </div> </div>  <p>Next, I renamed the ValuesController to PeopleController and modified the template code to query a list of Person objects:</p>  <div style="margin:0;display:inline;float:none;padding:0;" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:4e26f270-3175-465b-b599-8cf330bcfe43" class="wlWriterEditableSmartContent"> <div style="border:#000080 1px solid;color:#000;font-family:'Courier New', Courier, Monospace;font-size:10pt;"> <div style="background-color:#000000;overflow:auto;padding:2px 5px;"><span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">class</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">PeopleController</span><span style="background:#1e1e1e;color:#c8c8c8;"> : </span><span style="background:#1e1e1e;color:#4ec9b0;">ApiController</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">private</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">List</span><span style="background:#1e1e1e;color:#9b9b9b;">&lt;</span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#9b9b9b;">&gt;</span><span style="background:#1e1e1e;color:#c8c8c8;"> _list </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">List</span><span style="background:#1e1e1e;color:#9b9b9b;">&lt;</span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#9b9b9b;">&gt;</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><br>         <span style="background:#1e1e1e;color:#c8c8c8;">{ </span><br>             <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Person{</span><span style="background:#1e1e1e;color:#c8c8c8;"> Name </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;fred&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;">, Occupation </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;plumber&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;"> },</span><br>             <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Person{</span><span style="background:#1e1e1e;color:#c8c8c8;"> Name </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;bob&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;">, Occupation </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;lawyer&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;"> },</span><br>             <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Person{</span><span style="background:#1e1e1e;color:#c8c8c8;"> Name </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;flo&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;">, Occupation </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;pilot&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;"> },</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;">};</span><br> <br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#608b4e;">// GET /api/people</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#b8d7a3;">IEnumerable</span><span style="background:#1e1e1e;color:#9b9b9b;">&lt;</span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#9b9b9b;">&gt;</span><span style="background:#1e1e1e;color:#c8c8c8;"> Get()</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">return</span><span style="background:#1e1e1e;color:#c8c8c8;"> _list;</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">}</span><br> <br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#608b4e;">// GET /api/people/5</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#c8c8c8;"> Get(</span><span style="background:#1e1e1e;color:#569cd6;">int</span><span style="background:#1e1e1e;color:#c8c8c8;"> id)</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">return</span><span style="background:#1e1e1e;color:#c8c8c8;"> _list</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">SingleOrDefault(p </span><span style="background:#1e1e1e;color:#9b9b9b;">=&gt;</span><span style="background:#1e1e1e;color:#c8c8c8;"> p</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Id </span><span style="background:#1e1e1e;color:#9b9b9b;">==</span><span style="background:#1e1e1e;color:#c8c8c8;"> id);</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">}</span><br> <br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#608b4e;">// POST /api/people</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">void</span><span style="background:#1e1e1e;color:#c8c8c8;"> Post(</span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#c8c8c8;"> value)</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;">_list</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Add(value);</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">}</span><br> <br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#608b4e;">// PUT /api/people/5</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">void</span><span style="background:#1e1e1e;color:#c8c8c8;"> Put(</span><span style="background:#1e1e1e;color:#569cd6;">int</span><span style="background:#1e1e1e;color:#c8c8c8;"> id, </span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#c8c8c8;"> value)</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> item </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> _list</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">SingleOrDefault(p </span><span style="background:#1e1e1e;color:#9b9b9b;">=&gt;</span><span style="background:#1e1e1e;color:#c8c8c8;"> p</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Id </span><span style="background:#1e1e1e;color:#9b9b9b;">==</span><span style="background:#1e1e1e;color:#c8c8c8;"> id);</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">if</span><span style="background:#1e1e1e;color:#c8c8c8;"> (item </span><span style="background:#1e1e1e;color:#9b9b9b;">!=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">null</span><span style="background:#1e1e1e;color:#c8c8c8;">)</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>             <span style="background:#1e1e1e;color:#c8c8c8;">item</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Name </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> value</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Name;</span><br>             <span style="background:#1e1e1e;color:#c8c8c8;">item</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Occupation </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> value</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Occupation;</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;">}</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">}</span><br> <br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#608b4e;">// DELETE /api/people/5</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">public</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">void</span><span style="background:#1e1e1e;color:#c8c8c8;"> Delete(</span><span style="background:#1e1e1e;color:#569cd6;">int</span><span style="background:#1e1e1e;color:#c8c8c8;"> id)</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> item </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> _list</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">SingleOrDefault(p </span><span style="background:#1e1e1e;color:#9b9b9b;">=&gt;</span><span style="background:#1e1e1e;color:#c8c8c8;"> p</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Id </span><span style="background:#1e1e1e;color:#9b9b9b;">==</span><span style="background:#1e1e1e;color:#c8c8c8;"> id);</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">if</span><span style="background:#1e1e1e;color:#c8c8c8;"> (item </span><span style="background:#1e1e1e;color:#9b9b9b;">!=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">null</span><span style="background:#1e1e1e;color:#c8c8c8;">)</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>             <span style="background:#1e1e1e;color:#c8c8c8;">_list</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Remove(item);</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;">}</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">}</span></div> </div> </div>  <p>I’m not worried about the correctness or completeness of the http responses and behavior here as this post is about the client side of the code. Making the above code changes is enough to expose my RESTful api. For this example I an running the server on IISExpress on localhost – this enables me to test the GET calls using the browser by typing in <a title="http://localhost:60442/api/people" href="http://localhost:60442/api/people">http://localhost:60442/api/people</a> to IE10 on the Desktop. (since web api returns JSON by default I made the modification to the registry described here <a title="http://stackoverflow.com/questions/2483771/how-can-i-convince-ie-to-simply-display-application-json-rather-than-offer-to-do" href="http://stackoverflow.com/questions/2483771/how-can-i-convince-ie-to-simply-display-application-json-rather-than-offer-to-do">http://stackoverflow.com/questions/2483771/how-can-i-convince-ie-to-simply-display-application-json-rather-than-offer-to-do</a> to easily view the data coming back).</p>  <p>&#160;</p>  <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2012/03/webapiresponse.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="WebApiResponse" border="0" alt="WebApiResponse" src="http://peted.azurewebsites.net/wp-content/uploads/2012/03/webapiresponse_thumb.png" width="635" height="235" /></a></p>  <p>(I tested the other HTTP verbs using Fiddler by constructing requests by hand).</p>  <p>With that done it’s over to the Metro client.</p>  <p>I started with a blank c# Metro Style application and added a GridView to which I would bind my ViewModel (I tend to use the MVVM pattern). To support my MVVM architecture I rolled up a few helper classes; a DelegateCommand and a ViewModelBase class to provide INotifyPropertyChanged and an IsDesignMode property. The Expression Blend designer doesn’t work with network calls so the IsDesignMode property is used to facilitate design time data.</p>  <p>Next, I created some design-time data to enable me to design the ui in Blend</p>  <div style="margin:0;display:inline;float:none;padding:0;" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:595fd86f-d34a-486f-9983-246f1404c31d" class="wlWriterEditableSmartContent"> <div style="border:#000080 1px solid;color:#000;font-family:'Courier New', Courier, Monospace;font-size:10pt;"> <div style="background-color:#000000;overflow:auto;padding:2px 5px;"><span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">if</span><span style="background:#1e1e1e;color:#c8c8c8;"> (IsDesignMode)</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">People </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">ObservableCollection</span><span style="background:#1e1e1e;color:#9b9b9b;">&lt;</span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#9b9b9b;">&gt;</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#c8c8c8;"> { Name </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;design fred&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;">, Occupation </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;Nurse&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;"> },</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#c8c8c8;"> { Name </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;design bob&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;">, Occupation </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;Artist&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;"> },</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#c8c8c8;"> { Name </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;design flo&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;">, Occupation </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;Teacher&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;"> },</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#c8c8c8;"> { Name </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;design zak&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;">, Occupation </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;Fireman&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;"> },</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#c8c8c8;"> { Name </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;design rita&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;">, Occupation </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;Nurse&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;"> },</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">};</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">}</span></div> </div> </div>  <p>Here’s how it looked in Blend:</p>  <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2012/03/designdata.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="DesignData" border="0" alt="DesignData" src="http://peted.azurewebsites.net/wp-content/uploads/2012/03/designdata_thumb.png" width="645" height="337" /></a></p>  <p>With this out of the way I could get to the heart of the problem – making the client-side calls:</p>  <p>Starting with retrieving the initial list</p>  <div style="margin:0;display:inline;float:none;padding:0;" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:13462129-d60c-4fb1-884a-34891f5555df" class="wlWriterEditableSmartContent"> <div style="border:#000080 1px solid;color:#000;font-family:'Courier New', Courier, Monospace;font-size:10pt;"> <div style="background-color:#000000;overflow:auto;padding:2px 5px;"><span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> http </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">HttpClient</span><span style="background:#1e1e1e;color:#c8c8c8;">();</span><br> <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> resp </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">await</span><span style="background:#1e1e1e;color:#c8c8c8;"> http</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">GetAsync(</span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Uri</span><span style="background:#1e1e1e;color:#c8c8c8;">(apiRoot));</span><br> <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> stream </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">await</span><span style="background:#1e1e1e;color:#c8c8c8;"> resp</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Content</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">ReadAsStreamAsync();</span><br> <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> djs </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">DataContractJsonSerializer</span><span style="background:#1e1e1e;color:#c8c8c8;">(</span><span style="background:#1e1e1e;color:#569cd6;">typeof</span><span style="background:#1e1e1e;color:#c8c8c8;">(</span><span style="background:#1e1e1e;color:#4ec9b0;">List</span><span style="background:#1e1e1e;color:#9b9b9b;">&lt;</span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#9b9b9b;">&gt;</span><span style="background:#1e1e1e;color:#c8c8c8;">));</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">People </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">ObservableCollection</span><span style="background:#1e1e1e;color:#9b9b9b;">&lt;</span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#9b9b9b;">&gt;</span><span style="background:#1e1e1e;color:#c8c8c8;">((</span><span style="background:#1e1e1e;color:#b8d7a3;">IEnumerable</span><span style="background:#1e1e1e;color:#9b9b9b;">&lt;</span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#9b9b9b;">&gt;</span><span style="background:#1e1e1e;color:#c8c8c8;">)djs</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">ReadObject(stream));</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">stream</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Dispose();</span></div> </div> </div>  <p>Then, Deleting a Person from the list</p>  <div style="margin:0;display:inline;float:none;padding:0;" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:4c28b064-8782-4c89-995b-a202274c5d6e" class="wlWriterEditableSmartContent"> <div style="border:#000080 1px solid;color:#000;font-family:'Courier New', Courier, Monospace;font-size:10pt;"> <div style="background-color:#000000;overflow:auto;padding:2px 5px;"><span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> http </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">HttpClient</span><span style="background:#1e1e1e;color:#c8c8c8;">();</span><br> <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> resp </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">await</span><span style="background:#1e1e1e;color:#c8c8c8;"> http</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">DeleteAsync(</span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Uri</span><span style="background:#1e1e1e;color:#c8c8c8;">(apiRoot </span><span style="background:#1e1e1e;color:#9b9b9b;">+</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;/&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#9b9b9b;">+</span><span style="background:#1e1e1e;color:#c8c8c8;"> Selected</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Id));</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">resp</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">EnsureSuccessStatusCode();</span></div> </div> </div>  <p>Then, editing and adding, which I implemented in the same function:</p>  <div style="margin:0;display:inline;float:none;padding:0;" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:c22156ce-de1a-4c1d-b148-6c1eaff4dda1" class="wlWriterEditableSmartContent"> <div style="border:#000080 1px solid;color:#000;font-family:'Courier New', Courier, Monospace;font-size:10pt;"> <div style="background-color:#000000;max-height:500px;overflow:auto;padding:2px 5px;"><span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> http </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">HttpClient</span><span style="background:#1e1e1e;color:#c8c8c8;">();</span><br> <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> djs </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">DataContractJsonSerializer</span><span style="background:#1e1e1e;color:#c8c8c8;">(</span><span style="background:#1e1e1e;color:#569cd6;">typeof</span><span style="background:#1e1e1e;color:#c8c8c8;">(</span><span style="background:#1e1e1e;color:#4ec9b0;">Person</span><span style="background:#1e1e1e;color:#c8c8c8;">));</span><br> <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> ms </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">MemoryStream</span><span style="background:#1e1e1e;color:#c8c8c8;">();</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">djs</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">WriteObject(ms, person);</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">ms</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Position </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#b5cea8;">0</span><span style="background:#1e1e1e;color:#c8c8c8;">;</span><br> <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> sc </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">StreamContent</span><span style="background:#1e1e1e;color:#c8c8c8;">(ms);</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">sc</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Headers</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">ContentType </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> System</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Net</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Http</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Headers</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#4ec9b0;">MediaTypeHeaderValue</span><span style="background:#1e1e1e;color:#c8c8c8;">(</span><span style="background:#1e1e1e;color:#d69d85;">&quot;application/json&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;">);</span><br> <br> <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> resp </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> original </span><span style="background:#1e1e1e;color:#9b9b9b;">==</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">null</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#9b9b9b;">?</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">await</span><span style="background:#1e1e1e;color:#c8c8c8;"> http</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">PostAsync(</span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Uri</span><span style="background:#1e1e1e;color:#c8c8c8;">(apiRoot), sc) :</span><br>         <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">await</span><span style="background:#1e1e1e;color:#c8c8c8;"> http</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">PutAsync(</span><span style="background:#1e1e1e;color:#569cd6;">new</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Uri</span><span style="background:#1e1e1e;color:#c8c8c8;">(apiRoot </span><span style="background:#1e1e1e;color:#9b9b9b;">+</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#d69d85;">&quot;/&quot;</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#9b9b9b;">+</span><span style="background:#1e1e1e;color:#c8c8c8;"> original</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Id), sc);</span><br> <br> <span style="background:#1e1e1e;color:#c8c8c8;">ms</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Dispose();</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">resp</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">EnsureSuccessStatusCode();</span></div> </div> </div>  <p>In order to invoke the CRUD commands I added an application bar and populated it with app bar command buttons which I data bound to ICommands exposed by the View Model.</p>  <p>&#160;</p>  <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2012/03/appbar.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="appbar" border="0" alt="appbar" src="http://peted.azurewebsites.net/wp-content/uploads/2012/03/appbar_thumb.png" width="393" height="314" /></a></p>  <p>&#160;</p>  <p>One thing worth mentioning is that in order to edit the Person objects I needed some form of editor page. I wasn’t sure of the best Metro-Style way to implement it, but in the end I went for a modal dialog which looked similar to the built in message box.</p>  <p>&#160;</p>  <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2012/03/personeditor.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="PersonEditor" border="0" alt="PersonEditor" src="http://peted.azurewebsites.net/wp-content/uploads/2012/03/personeditor_thumb.png" width="655" height="358" /></a></p>  <p>&#160;</p>  <p>I created this as a full screen UserControl. </p>  <p>&#160;</p>  <p>The solution containing the web api project and the metro c# client is here <a title="https://skydrive.live.com/redir.aspx?cid=4f1b7368284539e5&amp;resid=4F1B7368284539E5!442&amp;parid=4F1B7368284539E5!123" href="https://skydrive.live.com/redir.aspx?cid=4f1b7368284539e5&amp;resid=4F1B7368284539E5!442&amp;parid=4F1B7368284539E5!123">https://skydrive.live.com/redir.aspx?cid=4f1b7368284539e5&amp;resid=4F1B7368284539E5!442&amp;parid=4F1B7368284539E5!123</a>.</p>  <p>UPDATE: An update for the Release Preview is here <a title="http://sdrv.ms/N4kfZT" href="http://sdrv.ms/N4kfZT">http://sdrv.ms/N4kfZT</a></p>
