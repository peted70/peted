---
layout: post
title: Office Add-In with Knockout.js
date: 2015-10-12 18:41
author: peted70
comments: true
categories: [Add-In, knockout, O365, Office, Office]
---
<p>Lately I have been investigating the new Office add-ins (the ones built on open web tech). Alongside the other additions to the Office platform; Unified APIs and AD apps they present a great surface area for solving higher level business productivity scenarios. Add to that Office’s 1.2B customers and the fact that Office now runs on the major mobile platforms makes this a powerful proposition. I have been gradually implementing samples for various different angles around the tech and thought it might help others to read about my experiences. First a little bit of background:</p> <h3>Add-Ins</h3> <p>Add-ins are a way to extend Office applications such as Word, Excel, etc. by providing a rendered surface onto one of a few possible integration points. The different options are Task Pane Add-In, Mail Add-In, Content Add-In or Add-In Command and a great description of the different types can be found here <a href="https://msdn.microsoft.com/en-us/library/office/jj220082.aspx#StartBuildingApps_TypesofApps">Add-Ins Platform Overview</a>. The Add-Ins can be hosted inside the standalone/desktop apps or from within Office365 or Outlook Web App and as the platform progresses more host environments come online for each different add-in type; I refer back to <a href="https://msdn.microsoft.com/en-us/library/office/jj220082.aspx#StartBuildingApps_SupportedApplications">Office applications that support Office Add-ins</a> for the updated matrix. I’m going to show how I built a Task Pane Add-In which brings content from Github into Word, Excel, etc. This diagram shows the architecture for an add-in:</p> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2015/10/taskpane-in-word-annot.png"><img title="taskpane in word annot" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="taskpane in word annot" src="http://peted.azurewebsites.net/wp-content/uploads/2015/10/taskpane-in-word-annot_thumb.png" width="741" height="363"></a></p> <p>&nbsp;</p> <p>Note that the web technologies and hosting are whatever you want them to be and access to the Office document model is provided via Office.js and there is a very clear security boundary between client and cloud as the content is hosted within iframes and calls to and from the object model are marshalled via postMessage. In addition, you need a manifest which is an xml file which describes your app to the store.</p><script src="https://gist.github.com/peted70/ee0479e177d8e543fb0d.js"></script> <h3>Getting Started</h3> <p>There are a few different ways to get started with this:</p> <blockquote> <p>If you have Visual Studio 2015 installed and you ticked the ‘Microsoft Office Developer Tools’ option when you installed then you are good to go.</p></blockquote> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2015/10/devtools.png"><img title="devtools" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="devtools" src="http://peted.azurewebsites.net/wp-content/uploads/2015/10/devtools_thumb.png" width="602" height="547"></a></p> <blockquote> <p>If you have Visual Studio 2013 then you can add the tools from here <a title="Office Developer Tools for Visual Studio 2013" href="http://aka.ms/OfficeDevToolsForVS2013">Office Developer Tools for Visual Studio 2013</a></p></blockquote> <blockquote> <p>You can use NAPA – an online IDE. <a title="https://www.napacloudapp.com/Getting-Started" href="https://www.napacloudapp.com/Getting-Started">https://www.napacloudapp.com/Getting-Started</a> (you need a Microsoft Account to log in here).</p></blockquote> <p>OR</p> <blockquote> <p>Use the Yeoman generator (yo office) <a title="http://dev.office.com/blogs/creating-office-add-ins-with-any-editor-introducing-yo-office" href="http://dev.office.com/blogs/creating-office-add-ins-with-any-editor-introducing-yo-office">http://dev.office.com/blogs/creating-office-add-ins-with-any-editor-introducing-yo-office</a> for a more lightweight experience. When I am on my mac I like to use the Yeoman generator with Visual Studio Code but insert your editor of choice here.</p></blockquote> <p>We really only need to generate the manifest really and have a way to upload this into the client application for debugging. If you use Visual Studio here then it will automate that for you so is convenient. You can also set up an add-in catalog and then debug your add-in from within the browser using the F12 developer tools.</p> <h3>Code</h3> <p>For this example I started out with Visual Studio and when you hit File &gt; New Project</p> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2015/10/newproject.png"><img title="newproject" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="newproject" src="http://peted.azurewebsites.net/wp-content/uploads/2015/10/newproject_thumb.png" width="735" height="528"></a></p> <p>You get this option (be careful the naming convention for add-ins was previously App!). </p> <p>The project wizard gives you a choice for the kind of Add-in you want to develop.</p> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2015/10/addinchoice.png"><img title="addinchoice" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="addinchoice" src="http://peted.azurewebsites.net/wp-content/uploads/2015/10/addinchoice_thumb.png" width="710" height="598"></a></p> <p>After generating we get a solution with two projects; one holding the manifest and one for an example web app. The example app is good to get started with but here you can point the manifest at any web url and develop your add-in that way. I used the sample app (which includes Office.js and some css) and added some scripts.I wanted a way to get some data from Github to email or add to Excel and imagined that it would fit nicely into a wider development team scenario. So, I discovered Github.js <a title="https://github.com/michael/github" href="https://github.com/michael/github">https://github.com/michael/github</a> and along with Knockout.js and the <a href="https://blogs.office.com/2015/08/31/introducing-office-ui-fabric-your-key-to-designing-add-ins-for-office/">Office UI Fabric</a> I had all of the moving parts for my Add-In.&nbsp; </p> <p>Knockout allows you to declaratively data bind a view model to HTML which is a concept I favour having done a lot of XAML data binding in the past. So I created a ViewModel using ko.observable which retrieved that data from Github (using Github.js). I then simply bound the data to my HTML page for display within the Add-In. This data could then be transformed into table form for injecting into the Office document at the users cursor. I allowed tables for a project summary, contributors and number of contributions and a commit list.</p> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2015/10/projsummary.png"><img title="projsummary" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="projsummary" src="http://peted.azurewebsites.net/wp-content/uploads/2015/10/projsummary_thumb.png" width="731" height="437"></a></p> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2015/10/commits.png"><img title="commits" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="commits" src="http://peted.azurewebsites.net/wp-content/uploads/2015/10/commits_thumb.png" width="733" height="463"></a></p> <p>Here’s the javascript to inject the contributors table into the Office doc:</p> <p><script src="https://gist.github.com/peted70/ce6e7806f5816e41e719.js"></script>And here’s the HTML showing the declarative databinding:</p><script src="https://gist.github.com/peted70/d8b3eca3991d863aef9e.js"></script> <p>The project can be found here <a title="https://github.com/UKDXOfficeDev/o365-github-addin" href="https://github.com/UKDXOfficeDev/o365-github-addin">https://github.com/UKDXOfficeDev/o365-github-addin</a></p>
