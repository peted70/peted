---
layout: post
title: metro c#–simple transform using touch
date: 2012-04-04 17:52
author: peted70
comments: true
categories: [c#, image, metro, Metro, pinch zoom, win8, Windows 8, WinRT, winrt, xaml]
---
<p>Well, this turned out to be pretty easy <img style="border-style:none;" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="http://peted.azurewebsites.net/wp-content/uploads/2012/04/wlemoticon-smile.png" />……</p>  <p>The aim was to carry out a simple image transform with touch; so pinch zoom, translate and rotate. This is how the code turned out.</p>  <p>First, the xaml, which is an Image inside a Canvas…</p>  <p>&#160;</p>  <p>   <div style="margin:0;display:inline;float:none;padding:0;" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:ac1ec7d9-4a44-4a81-ae49-5aefa1a7be71" class="wlWriterEditableSmartContent"> <div style="border:#000080 1px solid;color:#000;font-family:'Courier New', Courier, Monospace;font-size:10pt;"> <div style="background-color:#000000;overflow:auto;padding:2px 5px;"><span style="background:#1e1e1e;color:#ababab;"></span><span style="background:#1e1e1e;color:#808080;">&lt;</span><span style="background:#1e1e1e;color:#e6e6e6;">Canvas</span><span style="background:#1e1e1e;color:#808080;">&gt;</span><br>     <span style="background:#1e1e1e;color:#ababab;"></span><span style="background:#1e1e1e;color:#808080;">&lt;</span><span style="background:#1e1e1e;color:#e6e6e6;">Image</span><span style="background:#1e1e1e;color:#92caf4;"> x</span><span style="background:#1e1e1e;color:#808080;">:</span><span style="background:#1e1e1e;color:#92caf4;">Name</span><span style="background:#1e1e1e;color:#808080;">=</span><span style="background:#1e1e1e;color:#569cd6;">&quot;myImage&quot;</span><br>           <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#92caf4;"> ManipulationMode</span><span style="background:#1e1e1e;color:#808080;">=</span><span style="background:#1e1e1e;color:#569cd6;">&quot;All&quot;</span><br>           <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#92caf4;"> ManipulationDelta</span><span style="background:#1e1e1e;color:#808080;">=</span><span style="background:#1e1e1e;color:#569cd6;">&quot;Image_ManipulationDelta_1&quot;</span><br>           <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#92caf4;"> RenderTransformOrigin</span><span style="background:#1e1e1e;color:#808080;">=</span><span style="background:#1e1e1e;color:#569cd6;">&quot;0.5, 0.5&quot;</span><span style="background:#1e1e1e;color:#808080;">&gt;</span><br>         <span style="background:#1e1e1e;color:#ababab;"></span><span style="background:#1e1e1e;color:#808080;">&lt;</span><span style="background:#1e1e1e;color:#e6e6e6;">Image.RenderTransform</span><span style="background:#1e1e1e;color:#808080;">&gt;</span><br>             <span style="background:#1e1e1e;color:#ababab;"></span><span style="background:#1e1e1e;color:#808080;">&lt;</span><span style="background:#1e1e1e;color:#e6e6e6;">CompositeTransform</span><span style="background:#1e1e1e;color:#808080;">&gt;&lt;/</span><span style="background:#1e1e1e;color:#e6e6e6;">CompositeTransform</span><span style="background:#1e1e1e;color:#808080;">&gt;</span><br>         <span style="background:#1e1e1e;color:#ababab;"></span><span style="background:#1e1e1e;color:#808080;">&lt;/</span><span style="background:#1e1e1e;color:#e6e6e6;">Image.RenderTransform</span><span style="background:#1e1e1e;color:#808080;">&gt;</span><br>     <span style="background:#1e1e1e;color:#ababab;"></span><span style="background:#1e1e1e;color:#808080;">&lt;/</span><span style="background:#1e1e1e;color:#e6e6e6;">Image</span><span style="background:#1e1e1e;color:#808080;">&gt;</span><br> <span style="background:#1e1e1e;color:#ababab;"></span><span style="background:#1e1e1e;color:#808080;">&lt;/</span><span style="background:#1e1e1e;color:#e6e6e6;">Canvas</span><span style="background:#1e1e1e;color:#808080;">&gt;</span></div> </div> </div> </p>  <p>&#160;</p>  <p>Then the event handler for the ManipulationDelta event</p>  <p>&#160;</p>  <div style="margin:0;display:inline;float:none;padding:0;" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:cc1777be-c670-4448-889a-f1de3e0a6a8f" class="wlWriterEditableSmartContent"> <div style="border:#000080 1px solid;color:#000;font-family:'Courier New', Courier, Monospace;font-size:10pt;"> <div style="background-color:#000000;overflow:auto;padding:2px 5px;"><span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">private</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#569cd6;">void</span><span style="background:#1e1e1e;color:#c8c8c8;"> Image_ManipulationDelta_1(</span><span style="background:#1e1e1e;color:#569cd6;">object</span><span style="background:#1e1e1e;color:#c8c8c8;"> sender, </span><span style="background:#1e1e1e;color:#4ec9b0;">ManipulationDeltaRoutedEventArgs</span><span style="background:#1e1e1e;color:#c8c8c8;"> e)</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">{</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;"></span><span style="background:#1e1e1e;color:#569cd6;">var</span><span style="background:#1e1e1e;color:#c8c8c8;"> ct </span><span style="background:#1e1e1e;color:#9b9b9b;">=</span><span style="background:#1e1e1e;color:#c8c8c8;"> (</span><span style="background:#1e1e1e;color:#4ec9b0;">CompositeTransform</span><span style="background:#1e1e1e;color:#c8c8c8;">)myImage</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">RenderTransform;</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">ct</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">ScaleX </span><span style="background:#1e1e1e;color:#9b9b9b;">*=</span><span style="background:#1e1e1e;color:#c8c8c8;"> e</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Delta</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Scale;</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">ct</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">ScaleY </span><span style="background:#1e1e1e;color:#9b9b9b;">*=</span><span style="background:#1e1e1e;color:#c8c8c8;"> e</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Delta</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Scale;</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">ct</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">TranslateX </span><span style="background:#1e1e1e;color:#9b9b9b;">+=</span><span style="background:#1e1e1e;color:#c8c8c8;"> e</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Delta</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Translation</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">X;</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">ct</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">TranslateY </span><span style="background:#1e1e1e;color:#9b9b9b;">+=</span><span style="background:#1e1e1e;color:#c8c8c8;"> e</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Delta</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Translation</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Y;</span><br>     <span style="background:#1e1e1e;color:#c8c8c8;">ct</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Rotation </span><span style="background:#1e1e1e;color:#9b9b9b;">+=</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#b5cea8;">180.0</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#9b9b9b;">/</span><span style="background:#1e1e1e;color:#c8c8c8;"> </span><span style="background:#1e1e1e;color:#4ec9b0;">Math</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">PI </span><span style="background:#1e1e1e;color:#9b9b9b;">*</span><span style="background:#1e1e1e;color:#c8c8c8;"> e</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Delta</span><span style="background:#1e1e1e;color:#9b9b9b;">.</span><span style="background:#1e1e1e;color:#c8c8c8;">Rotation;</span><br> <br>     <span style="background:#1e1e1e;color:#c8c8c8;">UpdateControls(ct);</span><br> <span style="background:#1e1e1e;color:#c8c8c8;">}</span></div> </div> </div>  <p>&#160;</p>  <p>And here’s the sample running on my Build slate…</p>  <p>&#160;</p>  <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2012/04/pinchzoomspam.jpg"><img style="background-image:none;border-bottom:0;border-left:0;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;border-top:0;margin-right:auto;border-right:0;padding-top:0;" title="PinchZoomSpam" border="0" alt="PinchZoomSpam" src="http://peted.azurewebsites.net/wp-content/uploads/2012/04/pinchzoomspam_thumb.jpg" width="592" height="463" /></a></p>  <p>&#160;</p>  <p>The code is available here…</p>  <p><a title="https://skydrive.live.com/redir.aspx?cid=4f1b7368284539e5&amp;resid=4F1B7368284539E5!443&amp;parid=4F1B7368284539E5!123" href="https://skydrive.live.com/redir.aspx?cid=4f1b7368284539e5&amp;resid=4F1B7368284539E5!443&amp;parid=4F1B7368284539E5!123">https://skydrive.live.com/redir.aspx?cid=4f1b7368284539e5&amp;resid=4F1B7368284539E5!443&amp;parid=4F1B7368284539E5!123</a></p>
