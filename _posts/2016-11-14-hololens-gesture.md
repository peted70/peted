---
layout: single
title: HoloLens Gesture
date: 2016-11-14 19:24
author_profile: true
comments: true
categories: [HoloLens, HoloLens, HoloToolkit, Unity]
excerpt: ">This is the third part of a series. Steps to create the demo project that I used in my Future Decoded UK 2016 presentation. To get set up with the HoloToolkit in Unity..."
header:
    teaserlogo: 'assets/images/2016/11/Gesture.png'
    teaser: 'assets/images/2016/11/Gesture.png'
---
<a href="{{ site.baseurl }}/assets/images/2016/11/Gesture.png"><img title="Gesture" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="Gesture" src="{{ site.baseurl }}/assets/images/2016/11/Gesture_thumb.png" width="731" height="839"></a>  <blockquote> <p>This is the third part of a series see <a href="https://peted.azurewebsites.net/hololens-end-to-end-in-unity/">https://peted.azurewebsites.net/hololens-end-to-end-in-unity/</a></a> Steps to create the demo project that I used in my Future Decoded UK 2016 presentation</p></blockquote> <blockquote> <p>To get set up with the HoloToolkit in Unity see <a title="https://mtaulty.com/2016/11/10/hitchiking-the-holotoolkit-unity-leg-1/" href="https://mtaulty.com/2016/11/10/hitchiking-the-holotoolkit-unity-leg-1/">https://mtaulty.com/2016/11/10/hitchiking-the-holotoolkit-unity-leg-1/</a></p></blockquote> <h2>Stacking the Bottles</h2> <p>We want the bottles created in <a href="http://peted.azurewebsites.net/3d-models-from-blender-to-hololens/" target="_blank">3D Models: From Blender to HoloLens</a> to be stacked on top of the plinth and also to respect other physical properties like falling over. To achieve this we can add <a href="https://docs.unity3d.com/Manual/class-Rigidbody.html" target="_blank">RigidBody</a> components to each bottle, some colliders and add a box collider component to the plinth. The colliders I set up for the bottle consisted of two box colliders for the cap and the base of the bottle and a capsule collider for the body of the bottle. These were assembled by adding the components to the bottle prefab and then scaling and translating them until they were a close fit around the mesh of the bottle. Once done the bottles could be positioned into a stack. Adding the RigidBody means that we will later be able to apply a force to the surface of the bottles.</p> <p><a href="{{ site.baseurl }}/assets/images/2016/11/bottlestack.png"><img title="bottlestack" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="bottlestack" src="{{ site.baseurl }}/assets/images/2016/11/bottlestack_thumb.png" width="728" height="802"></a>&nbsp; </p> <h2>Knocking the Stack Over</h2> <p>In the previous post about Gaze we covered how to identify objects in your environment which the user would like to interact with. Once an object has been identified, in order to carry out the interaction the HoloLens platform offers two alternatives; gesture or voice commands. I will cover voice commands in the next post. The HoloLens is set up to have the ability to detect two different gestures; the bloom gesture and the ‘air tap’ (see <a title="https://developer.microsoft.com/en-us/windows/holographic/Gestures.html" href="https://developer.microsoft.com/en-us/windows/holographic/Gestures.html">https://developer.microsoft.com/en-us/windows/holographic/Gestures.html</a>). The bloom is a system-level gesture to invoke the Start menu but we can use the ‘air tap’ and associated gestures in our app. This is how I did that for my demo:</p> <p>Find the <strong>GestureManager</strong> script from the Project panel (use the search bar at the top of that panel)</p> <p>If you have followed the Gaze post then you will already have a Managers game object in your scene so you can drag the <strong>GestureManager</strong> script onto that. If not, create an empty game object and call it Managers and then drag the <strong>GestureManager</strong> script onto it. </p> <blockquote> <p>The GestureManager script declares the GazeManager script as a required component so if you don’t have one already one will automatically get added for you (as GestureManager relies on GazeManager otherwise it will not work)</p></blockquote> <p>The GestureManager script will listen for gestures and propagate a message to the focused object in the scene if one exists. It uses Unity’s <strong>SendMessage</strong> function to pass the messages along.</p> <blockquote> <p>Be aware that SendMessage uses reflection to match the function by it’s string name which is not necessarily the best option for performance and avoiding errors. Also, there is no concept of propagating events up/down the hierarchy that you might find in hierarchical user interface platforms. </p></blockquote> <p>So, if you want to call a function directly on the gazed-at object then this will work fine (I have another example in a later post where that is not the case). For my demo I want to knock over the bottles when tapped over. So the cursor hovers on a bottle, the user air taps and a force is applied to the bottle at that location. The GestureManager will call a function called OnSelect so we need to add one to a script applied to each bottle. Here is the OnSelect on my BottleScript.cs:</p><script src="https://gist.github.com/peted70/c27878f026fa8b3395093ef1c3304196.js"></script> <p>&nbsp; </p> <p>When this is called a force is applied in the opposite direction to the normal at the gaze intersection point. The Unity physics system takes care of the rest and the bottles will fall over. </p> <p>&nbsp;<iframe height="315" src="https://www.youtube.com/embed/RUFXjiezYaw" frameborder="0" width="560" allowfullscreen></iframe></p> <blockquote> <p>All resources used are available on Github <a href="https://github.com/peted70/fd-holodemo">https://github.com/peted70/fd-holodemo</a> (see the <a href="https://github.com/peted70/fd-holodemo/tree/GESTURE" target="_blank">GESTURE</a> branch)</p></blockquote>
