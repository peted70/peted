---
layout: single
title: metro background audio c# (consumer preview)
date: 2012-03-17 15:05
author_profile: true
comments: true
categories: [audio, audiocategory, background, c#, consumer preview, Metro, win8, Windows 8, WinRT, winrt, xaml]
header:
    teaserlogo: 'assets/images/'
    teaser: 'assets/images/'
---
<p>Peter Daukintis</p>  <p>Some changes occurred in the consumer preview release of Windows 8 regarding background audio; the steps required to get it working are outlined in this forum post </p>  <p><a title="http://social.msdn.microsoft.com/Forums/en-AU/winappswithcsharp/thread/2d3496df-a145-4d87-be08-aadd5a8098e2" href="http://social.msdn.microsoft.com/Forums/en-AU/winappswithcsharp/thread/2d3496df-a145-4d87-be08-aadd5a8098e2">http://social.msdn.microsoft.com/Forums/en-AU/winappswithcsharp/thread/2d3496df-a145-4d87-be08-aadd5a8098e2</a></p>  <p>The steps are </p>  <ul>   <li>Create a MediaElement and set it’s AudioCategory property to ‘BackgroundCapableMedia’      <div style="margin:0;display:inline;float:none;padding:0;" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:967b34fc-ab53-4b07-adc5-72a8ab46865b" class="wlWriterEditableSmartContent"> <div style="border:#000080 1px solid;color:#000;font-family:'Courier New', Courier, Monospace;font-size:10pt;"> <div style="background-color:#000000;overflow:auto;padding:2px 5px;"><span style="color:#6afd51;">&lt;</span><span style="color:#a2c4fd;">MediaElement</span><span style="color:#fdf8b9;"> x</span><span style="color:#6afd51;">:</span><span style="color:#fdf8b9;">Name</span><span style="color:#6afd51;">=</span><span style="color:#fcb581;">&quot;myMedia&quot;</span><br>              <span style="color:#f3f3f3;"></span><span style="color:#fdf8b9;"> Source</span><span style="color:#6afd51;">=</span><span style="color:#fcb581;">&quot;/Assets/Sleep Away.mp3&quot;</span><br>              <span style="color:#f3f3f3;"></span><span style="color:#fdf8b9;"> </span><span style="color:#ff0000;">AudioCategory</span><span style="color:#6afd51;">=</span><span style="color:#fcb581;">&quot;BackgroundCapableMedia&quot;</span><span style="color:#6afd51;">/&gt;</span></div> </div> </div>   </li>    <li>Update the app manifest to declare Background Tasks of types ‘Audio’ and ‘Control Channel’ </li>    <li>Implement event handlers for      <ul>       <li>MediaControl.PlayPressed </li>        <li>MediaControl.PausePressed </li>        <li>MediaControl.PlayPauseTogglePressed </li>        <li>MediaControl.StopPressed </li>     </ul>   </li> </ul>  <p>&#160;</p>  <div style="margin:0;display:inline;float:none;padding:0;" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:8ab44759-d85c-4ffc-a887-9f26fbd365d2" class="wlWriterEditableSmartContent"> <div style="border:#000080 1px solid;color:#000;font-family:'Courier New', Courier, Monospace;font-size:10pt;"> <div style="background-color:#000000;max-height:500px;overflow:auto;padding:2px 5px;"><span style="color:#f3f3f3;"></span><span style="color:#a2c4fd;">public</span><span style="color:#f3f3f3;"> BlankPage()</span><br> <span style="color:#f3f3f3;">{</span><br>     <span style="color:#f3f3f3;"></span><span style="color:#a2c4fd;">this</span><span style="color:#f3f3f3;">.InitializeComponent();</span><br>     <span style="color:#f3f3f3;"></span><span style="color:#ff0000;">MediaControl</span><span style="color:#f3f3f3;">.PlayPressed += MediaControl_PlayPressed;</span><br>     <span style="color:#f3f3f3;"></span><span style="color:#ff0000;">MediaControl</span><span style="color:#f3f3f3;">.PausePressed += MediaControl_PausePressed;</span><br>     <span style="color:#f3f3f3;"></span><span style="color:#ff0000;">MediaControl</span><span style="color:#f3f3f3;">.PlayPauseTogglePressed += MediaControl_PlayPauseTogglePressed;</span><br>     <span style="color:#f3f3f3;"></span><span style="color:#ff0000;">MediaControl</span><span style="color:#f3f3f3;">.StopPressed += MediaControl_StopPressed;</span><br> <span style="color:#f3f3f3;">}</span><br> <br> <span style="color:#f3f3f3;"></span><span style="color:#a2c4fd;">private</span><span style="color:#f3f3f3;"> </span><span style="color:#a2c4fd;">void</span><span style="color:#f3f3f3;"> MediaControl_StopPressed(</span><span style="color:#a2c4fd;">object</span><span style="color:#f3f3f3;"> sender, </span><span style="color:#a2c4fd;">object</span><span style="color:#f3f3f3;"> e)</span><br> <span style="color:#f3f3f3;">{</span><br>     <span style="color:#f3f3f3;"></span><span style="color:#ff0000;">myMedia</span><span style="color:#f3f3f3;">.Stop();</span><br> <span style="color:#f3f3f3;">}</span><br> <br> <span style="color:#f3f3f3;"></span><span style="color:#a2c4fd;">private</span><span style="color:#f3f3f3;"> </span><span style="color:#a2c4fd;">void</span><span style="color:#f3f3f3;"> MediaControl_PlayPauseTogglePressed(</span><span style="color:#a2c4fd;">object</span><span style="color:#f3f3f3;"> sender, </span><span style="color:#a2c4fd;">object</span><span style="color:#f3f3f3;"> e)</span><br> <span style="color:#f3f3f3;">{</span><br> <span style="color:#f3f3f3;">}</span><br> <br> <span style="color:#f3f3f3;"></span><span style="color:#a2c4fd;">private</span><span style="color:#f3f3f3;"> </span><span style="color:#a2c4fd;">void</span><span style="color:#f3f3f3;"> MediaControl_PausePressed(</span><span style="color:#a2c4fd;">object</span><span style="color:#f3f3f3;"> sender, </span><span style="color:#a2c4fd;">object</span><span style="color:#f3f3f3;"> e)</span><br> <span style="color:#f3f3f3;">{</span><br>     <span style="color:#f3f3f3;"></span><span style="color:#ff0000;">myMedia</span><span style="color:#f3f3f3;">.Pause();</span><br> <span style="color:#f3f3f3;">}</span><br> <br> <span style="color:#f3f3f3;"></span><span style="color:#a2c4fd;">private</span><span style="color:#f3f3f3;"> </span><span style="color:#a2c4fd;">void</span><span style="color:#f3f3f3;"> MediaControl_PlayPressed(</span><span style="color:#a2c4fd;">object</span><span style="color:#f3f3f3;"> sender, </span><span style="color:#a2c4fd;">object</span><span style="color:#f3f3f3;"> e)</span><br> <span style="color:#f3f3f3;">{</span><br>     <span style="color:#f3f3f3;"></span><span style="color:#ff0000;">myMedia</span><span style="color:#f3f3f3;">.Play();</span><br> <span style="color:#f3f3f3;">}</span></div> </div> </div>  <p>The media transport event handlers which need to be implemented are detailed here <a title="http://msdn.microsoft.com/en-us/library/windows/hardware/hh833781.aspx" href="http://msdn.microsoft.com/en-us/library/windows/hardware/hh833781.aspx">http://msdn.microsoft.com/en-us/library/windows/hardware/hh833781.aspx</a></p>  <p>&#160;</p>  <p>Here’s a working sample project.</p>  <p><a href="https://skydrive.live.com/redir.aspx?cid=4f1b7368284539e5&amp;resid=4F1B7368284539E5!440&amp;parid=4F1B7368284539E5!123&rlm;">https://skydrive.live.com/redir.aspx?cid=4f1b7368284539e5&amp;resid=4F1B7368284539E5!440&amp;parid=4F1B7368284539E5!123‏</a></p>  <p>UPDATE: I have updated this for the Release Preview (see <a title="http://babaandthepigman.wordpress.com/2012/08/12/metro-background-audio-c-release-preview/" href="http://babaandthepigman.wordpress.com/2012/08/12/metro-background-audio-c-release-preview/">http://babaandthepigman.wordpress.com/2012/08/12/metro-background-audio-c-release-preview/</a>)</p>
