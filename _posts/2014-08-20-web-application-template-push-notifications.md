---
layout: single
title: Web Application Template Push Notifications
date: 2014-08-20 15:54
author_profile: true
comments: true
categories: [Azure, Universal Apps, WAT]
header:
    teaserlogo: 'assets/images/'
    teaser: 'assets/images/'
---
<h3>Web App Template</h3> <p>The Web Application Template (WAT) is a great way to create a presence in the Windows App Stores if you already have a suitable web application. It provides a native application wrapper which provides code to hook your web app into platform features. These features are exposed via a JSON configuration file making it extremely easy to get up and running quickly. After installing the WAT you can create a Universal WAT app - which can be submitted to the Windows and/or Windows Phone Stores - via a template in Visual Studio. </p> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2014/08/UniversalProjectTemplate.png"><img title="Universal Project Template" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; float: none; margin-left: auto; display: block; border-top-width: 0px; margin-right: auto" border="0" alt="Universal Project Template" src="http://peted.azurewebsites.net/wp-content/uploads/2014/08/UniversalProjectTemplate_thumb.png" width="588" height="286"></a></p> <blockquote> <p>For further information please see <a href="http://wat.codeplex.com" target="_blank">http://wat.codeplex.com</a> and a video introduction here <a title="http://channel9.msdn.com/Shows/Web+Camps+TV/Building-Windows-8-Applications-with-HTML5-and-Web-App-Template" href="http://channel9.msdn.com/Shows/Web+Camps+TV/Building-Windows-8-Applications-with-HTML5-and-Web-App-Template">http://channel9.msdn.com/Shows/Web+Camps+TV/Building-Windows-8-Applications-with-HTML5-and-Web-App-Template</a>.</p></blockquote> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2014/08/jsonconfig.png"><img title="json-config" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; float: none; margin-left: auto; display: block; border-top-width: 0px; margin-right: auto" border="0" alt="json-config" src="http://peted.azurewebsites.net/wp-content/uploads/2014/08/jsonconfig_thumb.png" width="594" height="627"></a> </p> <p>Essentially, your web app is hosted inside a web control and the platform features are ‘plugged-in’ using javascript to provide a communication bridge between the native app (which is also written in javascript) and your web app. You can plug in live tiles, native app and navigation bars, sharing, etc. and you can easily modify the css of the running page to tailor the app experience. </p> <h3>Push Notifications</h3> <p>I will go through a step-by-step of how to set up and use push notifications with the Microsoft Web App Template (WAT). The WAT supports <a href="http://msdn.microsoft.com/en-us/library/jj927170.aspx" target="_blank">Azure Notification Hubs</a> which provide an easy-to-use infrastructure that enables you to send mobile push notifications from any backend (in the cloud or on-premises) to any mobile platform. In order to set up your notification hub you will need an Azure account; go here <a title="https://azure.microsoft.com" href="https://azure.microsoft.com">https://azure.microsoft.com</a> and sign up for a free trial if you don’t have an existing account set up. </p> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2014/08/azureservicebus.png"><img title="azure service bus" style="border-top: 0px; border-right: 0px; border-bottom: 0px; float: none; margin-left: auto; border-left: 0px; display: block; margin-right: auto" border="0" alt="azure service bus" src="http://peted.azurewebsites.net/wp-content/uploads/2014/08/azureservicebus_thumb.png" width="618" height="460"></a>You will need to create a service bus namespace and from their create a new notification hub</p> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2014/08/createnh.png"><img title="create-nh" style="border-top: 0px; border-right: 0px; border-bottom: 0px; float: none; margin-left: auto; border-left: 0px; display: block; margin-right: auto" border="0" alt="create-nh" src="http://peted.azurewebsites.net/wp-content/uploads/2014/08/createnh_thumb.png" width="726" height="290"></a> I followed the instructions here <a title="http://azure.microsoft.com/en-us/documentation/articles/notification-hubs-windows-store-dotnet-get-started/" href="http://azure.microsoft.com/en-us/documentation/articles/notification-hubs-windows-store-dotnet-get-started/">http://azure.microsoft.com/en-us/documentation/articles/notification-hubs-windows-store-dotnet-get-started/</a> to configure my windows store app and also my azure notification hub. I will just set this up for a Windows Store app; assuming the process is similar for Windows phone (and other platforms). I did wonder at first whether I needed to submit my app to the store to have it receiving notifications but that isn’t the case you just need to register the app with the service so you can get the SID as described at the link above.</p> <p>Once you have the SID and have associated your app with the store you can set up the WAT config file to register the app with the service. My completed config looked like this (with the secret key removed :)). The WAT app has code to register with the notification hub so we should be nearly done.</p> <div id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:5802c9e3-8b64-444c-9866-92c0648c0efb" class="wlWriterEditableSmartContent" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px"> <div class="le-pavsc-container"> <div style="background: #ddd; overflow: auto"> <ol start="1" style="background: #000000; margin: 0 0 0 2.5em; padding: 0 0 0 5px;"> <li><span style="background:#1e1e1e;color:#d7ba7d">&quot;notifications&quot;</span><span style="background:#1e1e1e;color:#b4b4b4">:</span><span style="background:#1e1e1e;color:#dcdcdc"> {</span></li> <li class="le-pavsc-even">    <span style="background:#1e1e1e;color:#dcdcdc"></span><span style="background:#1e1e1e;color:#d7ba7d">&quot;enabled&quot;</span><span style="background:#1e1e1e;color:#b4b4b4">:</span><span style="background:#1e1e1e;color:#dcdcdc"> </span><span style="background:#1e1e1e;color:#569cd6">true</span><span style="background:#1e1e1e;color:#b4b4b4">,</span></li> <li>    <span style="background:#1e1e1e;color:#dcdcdc"></span><span style="background:#1e1e1e;color:#d7ba7d">&quot;azureNotificationHub&quot;</span><span style="background:#1e1e1e;color:#b4b4b4">:</span><span style="background:#1e1e1e;color:#dcdcdc"> {</span></li> <li class="le-pavsc-even">        <span style="background:#1e1e1e;color:#dcdcdc"></span><span style="background:#1e1e1e;color:#d7ba7d">&quot;enabled&quot;</span><span style="background:#1e1e1e;color:#b4b4b4">:</span><span style="background:#1e1e1e;color:#dcdcdc"> </span><span style="background:#1e1e1e;color:#569cd6">true</span><span style="background:#1e1e1e;color:#b4b4b4">,</span></li> <li>        <span style="background:#1e1e1e;color:#dcdcdc"></span><span style="background:#1e1e1e;color:#d7ba7d">&quot;endpoint&quot;</span><span style="background:#1e1e1e;color:#b4b4b4">:</span><span style="background:#1e1e1e;color:#dcdcdc"> </span><span style="background:#1e1e1e;color:#d69d85">&quot;https://peted70.servicebus.windows.net/&quot;</span><span style="background:#1e1e1e;color:#b4b4b4">,</span></li> <li class="le-pavsc-even">        <span style="background:#1e1e1e;color:#dcdcdc"></span><span style="background:#1e1e1e;color:#d7ba7d">&quot;secret&quot;</span><span style="background:#1e1e1e;color:#b4b4b4">:</span><span style="background:#1e1e1e;color:#dcdcdc"> </span><span style="background:#1e1e1e;color:#d69d85">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span style="background:#1e1e1e;color:#b4b4b4">,</span></li> <li>        <span style="background:#1e1e1e;color:#dcdcdc"></span><span style="background:#1e1e1e;color:#d7ba7d">&quot;path&quot;</span><span style="background:#1e1e1e;color:#b4b4b4">:</span><span style="background:#1e1e1e;color:#dcdcdc"> </span><span style="background:#1e1e1e;color:#d69d85">&quot;wat-push&quot;</span><span style="background:#1e1e1e;color:#b4b4b4">,</span></li> <li class="le-pavsc-even">        <span style="background:#1e1e1e;color:#dcdcdc"></span><span style="background:#1e1e1e;color:#d7ba7d">&quot;tags&quot;</span><span style="background:#1e1e1e;color:#b4b4b4">:</span><span style="background:#1e1e1e;color:#dcdcdc"> </span><span style="background:#1e1e1e;color:#b4b4b4">[</span></li> <li>            <span style="background:#1e1e1e;color:#dcdcdc"></span><span style="background:#1e1e1e;color:#d69d85">&quot;watdemo&quot;</span></li> <li class="le-pavsc-even">        <span style="background:#1e1e1e;color:#dcdcdc"></span><span style="background:#1e1e1e;color:#b4b4b4">]</span></li> <li>    <span style="background:#1e1e1e;color:#dcdcdc">}</span></li> <li class="le-pavsc-even"><span style="background:#1e1e1e;color:#dcdcdc">}</span><span style="background:#1e1e1e;color:#b4b4b4">,</span></li> </ol> </div> </div> </div> <blockquote> <p>You also need to set your Windows Store app to be Toast Capable; this is a setting in the package manifest.</p> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2014/08/toastcapable.png"><img title="toast capable" style="border-top: 0px; border-right: 0px; border-bottom: 0px; float: none; margin-left: auto; border-left: 0px; display: block; margin-right: auto" border="0" alt="toast capable" src="http://peted.azurewebsites.net/wp-content/uploads/2014/08/toastcapable_thumb.png" width="439" height="211"></a> </p></blockquote> <p><a href="http://peted.azurewebsites.net/wp-content/uploads/2014/08/pushnotification.png">After configuring all of this I was beginning to wonder what I would do if it didn’t work! Luckily, the Azure portal has a Debug tab which allows sending test push notifications. I tried it out and you can see the result below:<img title="push notification" style="border-top: 0px; border-right: 0px; border-bottom: 0px; float: none; margin-left: auto; border-left: 0px; display: block; margin-right: auto" border="0" alt="push notification" src="http://peted.azurewebsites.net/wp-content/uploads/2014/08/pushnotification_thumb.png" width="756" height="548"></a> </p> <p></p> <p></p> <p></p> <p></p> <p>There is a <a href="http://msdn.microsoft.com/library/azure/dn223264.aspx" target="_blank">REST API</a> to use to send notifications or you can use the Nuget package here <a title="http://www.nuget.org/packages/WindowsAzure.ServiceBus/" href="http://www.nuget.org/packages/WindowsAzure.ServiceBus/">http://www.nuget.org/packages/WindowsAzure.ServiceBus/</a>. Either way, it’s straightforward to send the notifications see <a href="http://azure.microsoft.com/en-us/documentation/articles/notification-hubs-windows-store-dotnet-get-started/" target="_blank">here</a> for an example console app.</p>
